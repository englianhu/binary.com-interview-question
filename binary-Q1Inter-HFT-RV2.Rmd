---
title: "<img src='www/deriv.jpg' width='240'>"
subtitle: "[<span style='color:#DE5D83; background-color:black;'>Deriv.com</span> - Interday High Frequency Trading Models Comparison <span style='color:#4E79A7'>**Review (Part III)**</span>](https://github.com/englianhu/binary.com-interview-question)"
author: "[®γσ, Lian Hu](https://englianhu.github.io/) <img src='www/quantitative trader 1.jpg' width='13'> <img src='www/RYU.jpg' width='15'> <img src='www/ENG.jpg' width='24'> ® <img src='www/xueba1.jpg' width='14'>"
date: "`r lubridate::today('Asia/Tokyo')`"
output:
  html_document: 
    mathjax: https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js
    number_sections: yes
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: yes
      smooth_scroll: yes
    code_folding: hide
    css: CSSBackgrounds.css
---

<br>
<span style='color:green'>**Theme Song**</span>
<br>

<audio src="music/Mika - Elle me dit (happy song to be millionaire).mp3" controls></audio>
<br>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:white'>Elle me dit</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:white'>她对我说</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:white'>She told me</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:white'>彼女は私に言う</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:white'>écris une chanson contente</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:white'>写一首欢快的歌</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:white'>Write a happy song</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:white'>幸せな歌を書く</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:white'>Pas une chanson déprimante</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:white'>而不是悲伤的歌</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:white'>Not a depressing song</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:white'>気のめいるような歌ではない</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:white'>Une chanson que tout le monde aime</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:white'>一首让所有人都喜欢的歌</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:white'>A song that everyone loves</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:white'>みんなが大好きな曲</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:white'>Elle me dit</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:white'>她对我说</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:white'>She told me</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:white'>彼女は私に言う</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:azure'>Tu deviendras milliardaire</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:white'>你将成为亿万富翁</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:white'>You will become a millionaire</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:white'>あなたは億万長者になります</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:white'>Tu auras de quoi être fier</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:white'>你将为此感到骄傲</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:white'>You will be proud</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:white'>あなたは誇りに思うでしょう</span>

------

<br>

# Introduction

Due to below issues from [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:red'>*Blooper*</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT), here I review the research by using same dataset as we can know from below **Part I**.

- [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part I)*</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT-RV1) (in RPubs.com)
- [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part I)*</span>](https://beta.rstudioconnect.com/content/16240/binary-Q1Inter-HFT-RV1.html) (in RStudioConnect.com)

Here I use the <span style='color:white; background-color:#DE5D83;'>**β**est model</span> (ETS `MNZ` & `MNZ`) from above study but adjust the data size as we can know from next section.

The purpose of adjust the data size to be intraday :

- compare if improve the accuracy.
- easier the workload for other models comparison (use minimum data size to get optimal model).

<span style='color:green'>**Load Packages**</span>

```{r setup, warning = FALSE, message = FALSE}
if(!suppressPackageStartupMessages(require('BBmisc'))) {
  install.packages('BBmisc', dependencies = TRUE, INSTALL_opts = '--no-lock')
}
suppressPackageStartupMessages(require('BBmisc'))
# suppressPackageStartupMessages(require('rmsfuns'))

pkgs <- c('devtools', 'knitr', 'kableExtra', 'tint', 'furrr', 'tidyr', 
          'devtools','readr', 'lubridate', 'data.table', 'reprex', 
          'feather', 'purrr', 'quantmod', 'tidyquant', 'tibbletime', 
          'timetk', 'plyr', 'dplyr', 'stringr', 'magrittr', 'tdplyr', 
          'tidyverse', 'memoise', 'htmltools', 'formattable', 'dtplyr', 
          'zoo', 'forecast', 'seasonal', 'seasonalview', 'rjson', 
          'rugarch', 'rmgarch', 'mfGARCH', 'sparklyr', 'jcolors', 
          'microbenchmark', 'dendextend', 'lhmetools', 'ggthemr', 
          'stringr', 'pacman', 'profmem', 'ggthemes', 'flyingfox', 
          'htmltools', 'echarts4r', 'viridis', 'hrbrthemes', 'gtools', 
          'fable', 'fabletools', 'Rfast', 'Metrics', 'MLmetrics')

suppressAll(lib(pkgs))
# load_pkg(pkgs)

.dtr <- 'C:/Users/User/Documents/GitHub/binary.com-interview-question-data/'

## Set the timezone but not change the datetime
Sys.setenv(TZ = 'Asia/Tokyo')
## options(knitr.table.format = 'html') will set all kableExtra tables to be 'html', otherwise need to set the parameter on every single table.
options(warn = -1, knitr.table.format = 'html')#, digits.secs = 6)

## https://stackoverflow.com/questions/39417003/long-vectors-not-supported-yet-abnor-in-rmd-but-not-in-r-script
knitr::opts_chunk$set(warning = FALSE, #cache = TRUE, 
                      message = FALSE, cache.lazy = FALSE)

rm(pkgs)
```

# Data

## Read Data

```{r read-data, warning = FALSE, message = FALSE}
## check if data path set
if(!exists('dtr')) {
  dtr <- 'C:/Users/User/Documents/GitHub/binary.com-interview-question-data/'}

## save files if not exists
if(!file.exists(paste0(dtr, 'data/fx/USDJPY/dsmp.rds')) & exists('dsmp')) {
  saveRDS(dsmp, paste0(dtr, 'data/fx/USDJPY/dsmp.rds'))}

## read files if not exists
if(!exists('dsmp')) {
  dsmp <- readRDS(paste0(dtr, 'data/fx/USDJPY/dsmp.rds'))}
```

```{r smp-data, warning = FALSE, message = FALSE, results = 'asis'}
## plot sample data
dsmp[c(1:3, (nrow(dsmp)-3):nrow(dsmp)),] %>% 
  kbl(caption = '1 min Close Price Dataset', escape = FALSE) %>% 
  ## https://www.w3schools.com/cssref/css_colors.asp
  ## https://public.tableau.com/en-us/gallery/100-color-palettes?gallery=votd
  row_spec(0, background = 'DimGrey', color = 'gold', bold = TRUE) %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = 'Gray') %>% 
  column_spec(3, background = 'DarkGrey') %>% 
  column_spec(4, background = 'Gray') %>% 
  column_spec(5, background = 'DarkGrey') %>% 
  column_spec(6, background = '#4897D8') %>% 
  column_spec(7, background = '#556DAC') %>% 
  column_spec(8, background = '#92AAC7') %>% 
  column_spec(9, background = '#556DAC') %>% 
  column_spec(10, background = '#375E97') %>% 
  column_spec(11, background = 'CornflowerBlue') %>% 
  column_spec(12, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% ##`full_width = FALSE` will auto adjust every single columns width to fit the table full width.
  scroll_box(width = '100%', fixed_thead = TRUE, height = '400px')
```

*source : `r paste0(dim(dsmp), collapse = ' x ')`*

From above table, we can know the dataset gather from `r paste(range(dsmp$date), collapse = ' to ')` which is used in [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part I)*</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT-RV1).

# `ETS` Modelling

## Seasonal Data Modeling

Here I start my 1st forecast date from 1st trading datetime of 2016 (`r dsmp[year == 2016]$date[1]` which is 2nd year in dataset) which is used in [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part I)*</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT-RV1).

The default data size `7200` to forecast `1440` as we can know that's the optimal volume of observation data as we know from [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part I)*</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT-RV1) to compare with below seasonality.

## Daily Seasonal Data

### Modelling

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `1440` minutes (`1440` minutes is a trading day).

- [<span style='color:white; background-color:LightSlateGrey;'>*8.7 ARIMA modelling in R*</span> in **Forecasting: Principles and Practice (2nd Edition)**](https://otexts.com/fpp2/arima-r.html)
- [<span style='color:white; background-color:LightSlateGrey;'>*8.9 Seasonal ARIMA models*</span> in **Forecasting: Principles and Practice (2nd Edition)**](https://otexts.com/fpp2/seasonal-arima.html)
- [Seasonality in `auto.arima()` from `forecast` package](https://stackoverflow.com/a/37400899/3806250)

Refer to above function or load below r function.

### Dy >> Dy

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `1440 mins` (`24 hrs * 60 mins = 1440 mins` is a trading day).

```{r tseas, eval = FALSE}
tseas <- function(timeID, data = dsmp, data_len, 
                  hrz1 = c(1440, 7200), hrz2 = 1440, .model) {
  
  if(hrz1 == 1440) {
    
    tmp <- llply(1:length(timeID), function(i) {
      if(i == 1) {
        
        cat('\n===========================================\n')
        cat('train[', i, ']\n')
        print(train <- dsmp[date < timeID[i]][(.N - (data_len - 1)):.N])
        ctr <- train$sq[1]:(range(train$sq)[2] + hrz1)
        
        cat('\n-------------------------------------------\n')
        cat('train_test[', i, ']\n')
        print(train_test <- dsmp[sq %in% ctr])
        
        sets <- train[, .(index, close)] %>% 
          tk_ts(frequency = hrz1) %>% 
          ets(model = .model) %>% 
          forecast(h = hrz1) %>% 
          tk_tbl %>% 
          dplyr::mutate(index = train_test[(.N - hrz1 + 1):.N,]$index, 
                        mk.price = train_test[(.N - hrz1 + 1):.N,]$close) %>% 
          dplyr::rename(fc.price = `Point Forecast`) %>% 
          dplyr::select(index, mk.price, fc.price)
        
        cat('\n-------------------------------------------\n')
        cat('forecast[', i, ']\n')
        print(sets %>% as.data.table)
        
        fl_pth <- paste0(.dtr, 'data/fx/USDJPY/ts_ets_', data_len, 
                         '_', hrz1, '.', as_date(sets$index[1]), '.rds')
        saveRDS(sets, fl_pth)
        
        cat('\n', i, '=', paste0('~/data/fx/USDJPY/ts_ets_', .model, '_', 
                                 data_len, '_', hrz1, '.', 
                                 as_date(sets$index[1]), '.rds saved!'))
        cat('\n\n')
        rm(sets)
        
      } else if(i %in% seq(1, length(timeID), by = 6)[-1]) {
        
        
      } else if(i == length(timeID)) {
        
        
      } else  {
        
        lst_sq <- dsmp[date < timeID[i],][.N]$sq + 1
        
        cat('\n===========================================\n')
        cat('train[', i, ']\n')
        print(train <- dsmp[(lst_sq - data_len + 1):lst_sq])
        ctr <- train$sq[1]:(range(train$sq)[2] + hrz1)
        
        cat('\n-------------------------------------------\n')
        cat('train_test[', i, ']\n')
        print(train_test <- dsmp[sq %in% ctr])
        
        sets <- train[, .(index, close)] %>% 
          tk_ts(frequency = hrz1) %>% 
          ets(model = .model) %>% 
          forecast(h = hrz1) %>% 
          tk_tbl %>% 
          dplyr::mutate(index = train_test[(.N - hrz1 + 1):.N,]$index, 
                        mk.price = train_test[(.N - hrz1 + 1):.N,]$close) %>% 
          dplyr::rename(fc.price = `Point Forecast`) %>% 
          dplyr::select(index, mk.price, fc.price)
        
        cat('\n-------------------------------------------\n')
        cat('forecast[', i, ']\n')
        print(sets %>% as.data.table)
        
        fl_pth <- paste0(.dtr, 'data/fx/USDJPY/ts_ets_', data_len, 
                         '_', hrz1, '.', as_date(sets$index[1]), '.rds')
        saveRDS(sets, fl_pth)
        
        cat('\n', i, '=', paste0('~/data/fx/USDJPY/ts_ets_', .model, '_', 
                                 data_len, '_', hrz1, '.', 
                                 as_date(sets$index[1]), '.rds saved!'))
        cat('\n\n')
        rm(sets)
      }
    })
  } else if(hrz1 == 7200) {
    
    tmp <- llply(1:length(timeID), function(i) {
      
      if(i == 1) {
        
        cat('\n===========================================\n')
        cat('train[', i, ']\n')
        print(train <- dsmp[date < timeID[i]][(.N - (data_len - 1)):.N])
        ctr <- train$sq[1]:(range(train$sq)[2] + hrz1)
        
        cat('\n-------------------------------------------\n')
        cat('train_test[', i, ']\n')
        print(train_test <- dsmp[sq %in% ctr])
        
        sets <- train[, .(index, close)] %>% 
          tk_ts(frequency = hrz1) %>% 
          ets(model = .model) %>% 
          forecast(h = hrz1) %>% 
          tk_tbl %>% 
          dplyr::mutate(index = train_test[(.N - hrz1 + 1):.N,]$index, 
                        mk.price = train_test[(.N - hrz1 + 1):.N,]$close) %>% 
          dplyr::rename(fc.price = `Point Forecast`) %>% 
          dplyr::select(index, mk.price, fc.price)
        
        cat('\n-------------------------------------------\n')
        cat('forecast[', i, ']\n')
        print(sets %>% as.data.table)

        fl_pth <- paste0(.dtr, 'data/fx/USDJPY/ts_ets_', data_len, 
                         '_', hrz1, '.', as_date(sets$index[1]), '.rds')
        saveRDS(sets, fl_pth)
        
        cat('\n', i, '=', paste0('~/data/fx/USDJPY/ts_ets_', .model, '_', 
                                 data_len, '_', hrz1, '.', 
                                 as_date(sets$index[1]), '.rds saved!'))
        cat('\n\n')
        rm(sets)
        
      } else if(i > (length(timeID) - hrz1/hrz2) & i != length(timeID)) {
        
        lst_sq <- dsmp[date < timeID[i],][.N]$sq + 1
        ## filter the length of forecasted data to fit with train_test data 
        ##   when the length of forecasted data more then length of test data.
        #lst_date <- timeID[(length(timeID) - (hrz1/hrz2)):length(timeID)]
        lst_date <- timeID[timeID >= timeID[i]]
        lst_date_sq <- grep(
          timeID[i], timeID[
            (length(timeID) - (hrz1/hrz2 - 1)):length(timeID)])
        
        cat('\n===========================================\n')
        cat('train[', i, ']\n')
        print(train <- dsmp[(lst_sq - data_len + 1):lst_sq])
        ctr <- train$sq[1]:(range(train$sq)[2] + hrz1)
        
        cat('\n-------------------------------------------\n')
        cat('train_test[', i, ']\n')
        print(train_test <- dsmp[sq %in% ctr])
        
        sets <- train[, .(index, close)] %>% 
          tk_ts(frequency = hrz1) %>% 
          ets(model = .model) %>% 
          forecast(h = hrz1) %>% 
          tk_tbl
        
        sets <- sets[1:(hrz1 - (hrz2 * lst_date_sq)),] %>% 
          dplyr::mutate(index = train_test[
            (.N - (hrz1 - (hrz2 * lst_date_sq)) + 1):.N, ]$index, 
            mk.price = train_test[
              (.N - (hrz1 - (hrz2 * lst_date_sq)) + 1):.N, ]$close) %>% 
          dplyr::rename(fc.price = `Point Forecast`) %>% 
          dplyr::select(index, mk.price, fc.price)
        
        cat('\n-------------------------------------------\n')
        cat('forecast[', i, ']\n')
        print(sets %>% as.data.table)
        
        fl_pth <- paste0(.dtr, 'data/fx/USDJPY/ts_ets_', data_len, 
                         '_', hrz1, '.', as_date(sets$index[1]), '.rds')
        saveRDS(sets, fl_pth)
        
        cat('\n', i, '=', paste0('~/data/fx/USDJPY/ts_ets_', .model, '_', 
                                 data_len, '_', hrz1, '.', 
                                 as_date(sets$index[1]), '.rds saved!'))
        cat('\n\n')
        rm(sets)
        
      } else if(i %in% seq(1, length(timeID), by = 6)[-1]) {
        
        
      } else if(i == length(timeID)) {
        
        
      } else {
        
        lst_sq <- dsmp[date < timeID[i],][.N]$sq + 1
        
        cat('\n===========================================\n')
        cat('train[', i, ']\n')
        print(train <- dsmp[(lst_sq - data_len + 1):lst_sq])
        ctr <- train$sq[1]:(range(train$sq)[2] + hrz1)
        
        cat('\n-------------------------------------------\n')
        cat('train_test[', i, ']\n')
        print(train_test <- dsmp[sq %in% ctr])
        
        sets <- train[, .(index, close)] %>% 
          tk_ts(frequency = hrz1) %>% 
          ets(model = .model) %>% 
          forecast(h = hrz1) %>% 
          tk_tbl %>% 
          dplyr::mutate(index = train_test[(.N - hrz1 + 1):.N,]$index, 
                        mk.price = train_test[(.N - hrz1 + 1):.N,]$close) %>% 
          dplyr::rename(fc.price = `Point Forecast`) %>% 
          dplyr::select(index, mk.price, fc.price)
        
        cat('\n-------------------------------------------\n')
        cat('forecast[', i, ']\n')
        print(sets %>% as.data.table)
        
        fl_pth <- paste0(.dtr, 'data/fx/USDJPY/ts_ets_', data_len, 
                         '_', hrz1, '.', as_date(sets$index[1]), '.rds')
        saveRDS(sets, fl_pth)
        
        cat('\n', i, '=', paste0('~/data/fx/USDJPY/ts_ets_', .model, '_', 
                                 data_len, '_', hrz1, '.', 
                                 as_date(sets$index[1]), '.rds saved!'))
        cat('\n\n')
        rm(sets)
      }
    })
    
  } else {
    
    
  }
  return(tmp)
}
```

```{r intra_1440, eval = FALSE}
intra_1440 <- function(timeID, data = dsmp, data_len, 
                          hrz1 = 60, .model, vb = TRUE) {
  ## data_len 1440; hrz1 = 60
  intr <- data_len/hrz1
  
  tmp <- llply(1:length(timeID), function(i) {
    if(i == 1) {
      
      tmp2 <-llply(1:intr, function(j) {
        
        if(j == 1) {
          train <- dsmp[date < timeID[i]][(.N - (data_len - 1)):.N]
        } else  {
          
          lst_sq <- dsmp[date < timeID[i]][(.N - (hrz1 * (intr - j + 1) - 1))]$sq
          train <- dsmp[lst_sq:(lst_sq + data_len - 1)]
        }
        ctr <- train$sq[1]:(range(train$sq)[2] + hrz1)
        
        if(vb == TRUE) {
          cat('\n===========================================\n')
          cat('train[', i, '-', j, ']\n')
          print(train)
        }
        
        train_test <- dsmp[sq %in% ctr]
        if(vb == TRUE) {
          cat('\n-------------------------------------------\n')
          cat('train_test[', i, '-', j, ']\n')
          print(train_test)
        }
        
        sets <- train[, .(index, close)] %>% 
          tk_ts(frequency = hrz1) %>% 
          ets(model = .model) %>% 
          forecast(h = hrz1) %>% 
          tk_tbl %>% 
          dplyr::mutate(index = train_test[(.N - hrz1 + 1):.N,]$index, 
                        mk.price = train_test[(.N - hrz1 + 1):.N,]$close) %>% 
          dplyr::rename(fc.price = `Point Forecast`) %>% 
          dplyr::select(index, mk.price, fc.price)
        
        if(vb == TRUE) {
          cat('\n-------------------------------------------\n')
          cat('forecast[', i, '-', j, ']\n')
          print(sets %>% as.data.table)
        }
        
        fl_pth <- paste0(
          .dtr, 'data/fx/USDJPY/intraday/ts_ets_', .model, '_', data_len, 
          '_', hrz1, '.p', j, '.', as_date(sets$index[1]), '.rds')
        saveRDS(sets, fl_pth)
        
        cat('\n', i, '-', j, '=', 
            paste0('~/data/fx/USDJPY/intraday/ts_ets_', .model, '_', 
                   data_len, '_', hrz1, '.p', j, '.', 
                   as_date(sets$index[1]), '.rds saved!'))
        cat('\n\n')
        rm(sets)
      })
      return(tmp2)
      
    } else if(i %in% seq(1, length(timeID), by = 6)[-1]) {
      
      
    } else if(i == length(timeID)) {
      
      
    } else  {
      
      tmp2 <-llply(1:intr, function(j) {
        
        if(j == 1) {
          lst_sq <- dsmp[date < timeID[i],][.N]$sq + 1
          
        } else {
          lst_sq <- dsmp[date < timeID[i],][.N]$sq + 1 + hrz1 * (j - 1)
        }
        
        train <- dsmp[(lst_sq - data_len + 1):lst_sq]
        ctr <- train$sq[1]:(range(train$sq)[2] + hrz1)
        
        if(vb == TRUE) {
          cat('\n===========================================\n')
          cat('train[', i, '-', j, ']\n')
          print(train)
        }
        
        train_test <- dsmp[sq %in% ctr]
        if(vb == TRUE) {
          cat('\n-------------------------------------------\n')
          cat('train_test[', i, '-', j, ']\n')
          print(train_test)
        }
        
        sets <- train[, .(index, close)] %>% 
          tk_ts(frequency = hrz1) %>% 
          ets(model = .model) %>% 
          forecast(h = hrz1) %>% 
          tk_tbl %>% 
          dplyr::mutate(index = train_test[(.N - hrz1 + 1):.N,]$index, 
                        mk.price = train_test[(.N - hrz1 + 1):.N,]$close) %>% 
          dplyr::rename(fc.price = `Point Forecast`) %>% 
          dplyr::select(index, mk.price, fc.price)
        
        if(vb == TRUE) {
          cat('\n-------------------------------------------\n')
          cat('forecast[', i, '-', j, ']\n')
          print(sets %>% as.data.table)
        }
        
        fl_pth <- paste0(
          .dtr, 'data/fx/USDJPY/intraday/ts_ets_', .model, '_', data_len, 
          '_', hrz1, '.p', j, '.', as_date(sets$index[1]), '.rds')
        saveRDS(sets, fl_pth)
        
        cat('\n', i, '-', j, '=', 
            paste0('~/data/fx/USDJPY/intraday/ts_ets_', .model, '_', 
                   data_len, '_', hrz1, '.p', j, '.', 
                   as_date(sets$index[1]), '.rds saved!'))
        cat('\n\n')
        rm(sets)
      })
      return(tmp2)
    }
  })
  return(tmp)
}
```

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/tseas.R')
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 1440
hrz2 <- 1440

llply(ets.m, function(md) {
  tseas(timeID = timeID, dsmp, 
        data_len = data_len, hrz1 = hrz1, 
        hrz2 = hrz2, .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/'), pattern = '^ts_ets_MNN_1440_1440.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 1440)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 12Hr

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `720 mins` (`12 hrs * 60 mins = 720 mins` is half trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 720

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_720.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 720)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 8Hr

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `480 mins` (`8 hrs * 60 mins = 480 mins` is 8 hours in a trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 480

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_480.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 480)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 6Hr

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `360 mins` (`6 hrs * 60 mins = 360 mins` is 6 hours in a trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 360

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_360.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 360)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 4Hr

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `240 mins` (`4 hrs * 60 mins = 240 mins` is 4 hours in a trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 240

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_240.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 240)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 3Hr

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `180 mins` (`3 hrs * 60 mins = 180 mins` is 3 hours in a trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 180

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_180.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 180)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 2Hr

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `120 mins` (`2 hrs * 60 mins = 120 mins` is 2 hours in a trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 120

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_120.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 120)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 1Hr

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `60 mins` (`1 hr * 60 mins = 60 mins` is 1 hour in a trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 60

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_60.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 60)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 30mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `30 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 30

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_30.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 30)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 20mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `20 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 20

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_20.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 20)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 15mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `15 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 15

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_15.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 15)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 10mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `10 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 10

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_10.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 10)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 8mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `8 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 8

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_8.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 8)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 6mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `6 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 6

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_6.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

smp %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 6)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = '#556DAC') %>% 
  column_spec(2, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(3, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 5mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `5 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 5

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, eval = FALSE}
#```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_5.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

smp %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 6)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = '#556DAC') %>% 
  column_spec(2, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(3, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 4mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `4 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 4

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, eval = FALSE}
#```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_4.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

smp %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 6)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = '#556DAC') %>% 
  column_spec(2, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(3, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 3mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `3 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 3

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, eval = FALSE}
#```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_3.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

smp %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 6)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = '#556DAC') %>% 
  column_spec(2, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(3, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 2mins

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `2 mins` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 2

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, eval = FALSE}
#```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_2.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

smp %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 6)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = '#556DAC') %>% 
  column_spec(2, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(3, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Dy >> 1min

I set the length of data as Daily (`1440 mins` which is 1 trading days) to forecast `1 min` in advance.

```{r, eval = FALSE}
# --------- eval=FALSE ---------
ets.m <- 'MNN'
source('function/intra_1440.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 1440
hrz1 <- 1

llply(ets.m, function(md) {
  intra_1440(timeID = timeID, dsmp, 
             data_len = data_len, hrz1 = hrz1, 
             .model = md)
  })
```

```{r, eval = FALSE}
#```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_1440_1.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

smp %>% 
  kbl(caption = 'Data Sample (ETS MNN 1440 forecast 6)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = '#556DAC') %>% 
  column_spec(2, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(3, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

## Weekly Seasonal Data

### Wk >> 12Hr

I set the length of data as Daily (`5 days * 1440 mins = 7200 mins` which is 5 trading days) to forecast `720 mins` (`12 hrs * 60 mins = 720 mins` is half trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
## set all models provided by ets function.
if(!exists('ets.m')) ets.m <- 'MNN'
if(!exists('intra_7200')) source('function/intra_7200.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 7200
hrz1 <- 720

llply(ets.m, function(md) {
  intra_7200(timeID = timeID, dsmp, 
        data_len = data_len, hrz1 = hrz1, 
        .model = md)
  })
```

```{r, warning = FALSE, message = FALSE, results='asis'}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_7200_720.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 7200 forecast 720)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Wk >> 6Hr

I set the length of data as Daily (`5 days * 1440 mins = 7200 mins` which is 5 trading days) to forecast `360 mins` (`6 hrs * 60 mins = 360 mins` is half trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
## set all models provided by ets function.
if(!exists('ets.m')) ets.m <- 'MNN'
if(!exists('intra_7200')) source('function/intra_7200.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 7200
hrz1 <- 360

llply(ets.m, function(md) {
  intra_7200(timeID = timeID, dsmp, 
        data_len = data_len, hrz1 = hrz1, 
        .model = md)
  })
```

```{r, eval = FALSE}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_7200_360.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 7200 forecast 360)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Wk >> 3Hr

I set the length of data as Daily (`5 days * 1440 mins = 7200 mins` which is 5 trading days) to forecast `180 mins` (`3 hrs * 60 mins = 180 mins` is half trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
## set all models provided by ets function.
if(!exists('ets.m')) ets.m <- 'MNN'
if(!exists('intra_7200')) source('function/intra_7200.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 7200
hrz1 <- 180

llply(ets.m, function(md) {
  intra_7200(timeID = timeID, dsmp, 
        data_len = data_len, hrz1 = hrz1, 
        .model = md)
  })
```

```{r, eval = FALSE}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_7200_180.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 7200 forecast 180)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

### Wk >> 1Hr

I set the length of data as Daily (`5 days * 1440 mins = 7200 mins` which is 5 trading days) to forecast `60 mins` (`3 hrs * 60 mins = 60 mins` is half trading day).

```{r, eval = FALSE}
# --------- eval=FALSE ---------
## set all models provided by ets function.
if(!exists('ets.m')) ets.m <- 'MNN'
if(!exists('intra_7200')) source('function/intra_7200.R')

timeID <- unique(dsmp$date)
bse <- dsmp[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
timeID %<>% .[. >= bse]
#timeID %<>% .[. >= as_date('2016-01-04')]
data_len <- 7200
hrz1 <- 60

llply(ets.m, function(md) {
  intra_7200(timeID = timeID, dsmp, 
        data_len = data_len, hrz1 = hrz1, 
        .model = md)
  })
```

```{r, eval = FALSE}
fl <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN_7200_60.p_[0-9]{0,}.[0-9]{4}')[1]
smp <- readRDS(paste0(.dtr, 'data/fx/USDJPY/intraday/', fl))

data.frame(smp)[
  c(1:3, (nrow(smp)-2):nrow(smp)),] %>% 
  kbl(caption = 'Data Sample (ETS MNN 7200 forecast 60)', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  #column_spec(3, background = 'LightSlateGrey') %>% 
  #column_spec(3, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro', color = 'goldenrod') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(smp), collapse = ' x ')`*

```{r include = FALSE}
if(exists('smp')) rm(smp)
if(exists('fl')) rm(fl)
```

```{r, include = FALSE}
if(exists('bse')) rm(bse)
if(exists('ctr')) rm(ctr)
if(exists('data_len')) rm(data_len)
if(exists('ets.m')) rm(ets.m)
if(exists('hrz1')) rm(hrz1)
if(exists('hrz2')) rm(hrz2)
if(exists('i')) rm(i)
if(exists('lst_sq')) rm(lst_sq)
if(exists('timeID')) rm(timeID)
```

# Comparison

## Read Models

### Grouped Models

Here I read the saved models.

```{r, eval = FALSE}
## Get all files.
fls <- paste0(.dtr, 'data/fx/USDJPY/') %>% 
  list.files(., pattern = '^ts_ets_MNN_7200_1440.[0-9]{4}')

fls_pth <- paste0(.dtr, 'data/fx/USDJPY/', fls)

mds_ets_MNN_7200_1440 <- ldply(1:length(fls), function(i) {
  
  nms <- fls[i] %>% 
    str_replace_all('.rds', '') %>% 
    str_split('_|\\.') %>% 
    .[[1]]
  
  nms <- nms
  names(nms) <- c('t_series', 'model', 'sub_model', 
                  'data_min', 'fc_min', 'date')
  
  datset2 <- t(nms) %>% 
    data.frame %>% 
    mutate(model =factor(model), sub_model = factor(sub_model), 
           data_min = as.numeric(data_min), 
           fc_min = as.numeric(fc_min), 
           part = 1, 
           date = as_date(date))
  
  datset <- read_rds(fls_pth[i])
  
  res <- tibble(datset2, datset) %>% 
    dplyr::select(index, t_series, model, sub_model, data_min, 
                  fc_min, part, date, mk.price, fc.price)
  res <- res[!is.na('mk.price'),]
  cat(nms, '\n')
  
  return(res)
  
}) %>% 
  as_tibble

## https://tysonbarrett.com/jekyll/update/2019/10/06/datatable_memory/
## http://brooksandrew.github.io/simpleblog/articles/advanced-data-table/
## https://atrebas.github.io/post/2019-03-03-datatable-dplyr/

saveRDS(mds_ets_MNN_7200_1440, 
        paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_7200_1440.rds'))
```

```{r, eval = FALSE}
## Get all files.
fls <- paste0(.dtr, 'data/fx/USDJPY/intraday/') %>% 
  list.files(., pattern = '^ts_ets_MNN_')
fls_pth <- paste0(.dtr, 'data/fx/USDJPY/intraday/', fls)

mds_ets_MNN_intraday <- ldply(1:length(fls), function(i) {
  
  nms <- fls[i] %>% 
    str_replace_all('.rds', '') %>% 
    str_split('_|\\.') %>% 
    .[[1]]
  
  nms <- nms[-6]
  names(nms) <- c('t_series', 'model', 'sub_model', 
                  'data_min', 'fc_min', 'part', 'date')
  
  datset2 <- t(nms) %>% 
    data.frame %>% 
    mutate(model =factor(model), sub_model = factor(sub_model), 
           data_min = as.numeric(data_min), 
           fc_min = as.numeric(fc_min), 
           part = as.numeric(part), 
           date = as_date(date))
  
  datset <- read_rds(fls_pth[i])
  
  res <- tibble(datset2, datset) %>% 
    dplyr::select(index, t_series, model, sub_model, data_min, 
                  fc_min, part, date, mk.price, fc.price)
  res <- res[!is.na('mk.price'),]
  cat(nms, '\n')
  
  return(res)
  
}) %>% 
  as_tibble

## https://tysonbarrett.com/jekyll/update/2019/10/06/datatable_memory/
## http://brooksandrew.github.io/simpleblog/articles/advanced-data-table/
## https://atrebas.github.io/post/2019-03-03-datatable-dplyr/

saveRDS(mds_ets_MNN_intraday, paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday.rds'))
```

```{r, eval = FALSE}
mds_ets_MNN_7200_1440 <- read_rds(
  paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_7200_1440.rds'))

mds_ets_MNN_intraday <- read_rds(
  paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday.rds'))
```

### Long Format

```{r, eval = FALSE}
rm(list = ls())

if(!exists('mds_ets_MNN_7200_1440')) {
  mds_ets_MNN_7200_1440 <- read_rds(
    paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_7200_1440.rds')) }

if(!exists('mds_ets_MNN_intraday')) {
  mds_ets_MNN_intraday <- read_rds(
    paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday.rds')) }

mds_ets_MNN_intraday <- rbind(mds_ets_MNN_7200_1440, mds_ets_MNN_intraday)

mds_ets_MNN_intraday_cmp <- mds_ets_MNN_intraday %>% 
    tidyr::unite(model, t_series:fc_min) %>%  #different with mds_ts_cmp
    as.data.table %>% 
    .[, .(index, model, mk.price, fc.price)]

## ----------------------------------------
## fromLast = FALSE
mds_ets_MNN_intraday_cmp_fLF <- unique(
  mds_ets_MNN_intraday_cmp_fLF[, .(index, model, mk.price, fc.price)])

## save dataset in data.table format
saveRDS(mds_ets_MNN_intraday_cmp_fLF, 
        paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday_cmp_fLF.rds'))

## ----------------------------------------
## fromLast = TRUE
mds_ets_MNN_intraday_cmp_fLT <- unique(
  mds_ets_MNN_intraday_cmp_fLT[, .(index, model, mk.price, fc.price)])

## save dataset in data.table format
saveRDS(mds_ets_MNN_intraday_cmp_fLT, 
        paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday_cmp_fLT.rds'))

## ----------------------------------------
## convert to long format for plot chart
## fromLast = FALSE
prc <- unique(mds_ets_MNN_intraday_cmp[, .(index, model, mk.price)], fromLast = FALSE)
prc <- prc[, model := 'actual'][]
setnames(prc, old = 'mk.price', new = 'price')
prc <- unique(prc, fromLast = FALSE)

mds_ets_MNN_intraday_grph <- unique(
  mds_ets_MNN_intraday_cmp[, .(index, model, fc.price)], fromLast = FALSE)
setnames(mds_ets_MNN_intraday_grph, old = 'fc.price', new = 'price')

mds_ets_MNN_intraday_grph <- rbind(mds_ets_MNN_intraday_grph, prc)
mds_ets_MNN_intraday_grph_fLF <- data.table(mds_ets_MNN_intraday_grph)[order(index)]
rm(prc)

## save dataset in data.table format
saveRDS(mds_ets_MNN_intraday_grph_fLF, 
        paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday_grph_fLF.rds'))

## ----------------------------------------
## fromLast = TRUE
prc <- unique(mds_ets_MNN_intraday_cmp[, .(index, model, mk.price)], fromLast = TRUE)
prc <- prc[, model := 'actual'][]
setnames(prc, old = 'mk.price', new = 'price')
prc <- unique(prc, fromLast = TRUE)

mds_ets_MNN_intraday_grph <- unique(
  mds_ets_MNN_intraday_cmp[, .(index, model, fc.price)], fromLast = TRUE)
setnames(mds_ets_MNN_intraday_grph, old = 'fc.price', new = 'price')

mds_ets_MNN_intraday_grph <- rbind(mds_ets_MNN_intraday_grph, prc)
mds_ets_MNN_intraday_grph_fLT <- data.table(mds_ets_MNN_intraday_grph)[order(index)]
rm(prc)

## save dataset in data.table format
saveRDS(mds_ets_MNN_intraday_grph_fLT, 
        paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday_grph_fLT.rds'))
```

There has a small mistake in previous paper [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part I)*</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT-RV1) but doesn't affect since I only want to compare the models and here I use the same `MNN` model and filter `unique(fromLast = FALSE)` and `unique(fromLast = TRUE)`.

```{r}
if(!exists('mds_ets_MNN_intraday_grph_fLF')) {
  mds_ets_MNN_intraday_grph_fLF <- readRDS(
    paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday_grph_fLF.rds')) }

if(!exists('mds_ets_MNN_intraday_grph_fLT')) {
  mds_ets_MNN_intraday_grph_fLT <- readRDS(
    paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday_grph_fLT.rds')) }
```

```{r, warning = FALSE, results = 'asis'}
data.frame(mds_ets_MNN_intraday_grph_fLF)[
  c(1:5, (nrow(mds_ets_MNN_intraday_grph_fLF)-5):nrow(mds_ets_MNN_intraday_grph_fLF)),] %>% 
  kbl(caption = 'Data Sample', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = 'grey') %>% 
  column_spec(3, background = '#556DAC') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(mds_ets_MNN_intraday_grph_fLF), collapse = ' x ')`*

```{r, warning = FALSE, results = 'asis'}
data.frame(mds_ets_MNN_intraday_grph_fLT)[
  c(1:5, (nrow(mds_ets_MNN_intraday_grph_fLT)-5):nrow(mds_ets_MNN_intraday_grph_fLT)),] %>% 
  kbl(caption = 'Data Sample', escape = FALSE) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = 'grey') %>% 
  column_spec(3, background = '#556DAC') %>% 
  column_spec(4, background = 'LightGray', color = 'goldenrod') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(mds_ets_MNN_intraday_grph_fLT), collapse = ' x ')`*

## Line Chart

### `unique(x, fromLast = FALSE)` Dataset

```{r, eval = FALSE}
## https://www.r-graph-gallery.com/line-chart-several-groups-ggplot2.html
plt <- mds_ets_MNN_intraday_grph_fLF %>% 
  ggplot(aes(x = index, y = price, group = model, color = model)) + 
  geom_line() + 

  labs(title = '1 min Open Price Forecasting', 
       subtitle = paste('From', range(unique(mds_ets_MNN_intraday_grph_fLF$index))[1L], 
                        'to', range(unique(mds_ets_MNN_intraday_grph_fLF$index))[2L]), 
       caption = "Data source: fxcm") + 
  ylab('Exchange Rates USD/JPY') + 
  theme_economist() + 
  theme(legend.position = 'right')

#ggplotly(plt)
plt
```

Due to the high volume of data, here I skip the **line chart**.

```{r, include = FALSE}
if(exists('plt')) rm(plt)
```

### `unique(x, fromLast = TRUE)` Dataset

```{r, eval = FALSE}
## https://www.r-graph-gallery.com/line-chart-several-groups-ggplot2.html
plt <- mds_ets_MNN_intraday_grph_fLT %>% 
  ggplot(aes(x = index, y = price, group = model, color = model)) + 
  geom_line() + 

  labs(title = '1 min Open Price Forecasting', 
       subtitle = paste('From', range(unique(mds_ets_MNN_intraday_grph_fLT$index))[1L], 
                        'to', range(unique(mds_ets_MNN_intraday_grph_fLT$index))[2L]), 
       caption = "Data source: fxcm") + 
  ylab('Exchange Rates USD/JPY') + 
  theme_economist() + 
  theme(legend.position = 'right')

#ggplotly(plt)
plt
```

Due to the high volume of data, here I skip the **line chart**.

```{r, include = FALSE}
if(exists('plt')) rm(plt)
```

## Table

### `unique(x, fromLast = FALSE)` Dataset

Below table compares the models.

```{r, eval = FALSE}
rm(list = ls())

## report for mds_ets_MNN_intraday_cmp_fLF
if(!exists('mds_ets_MNN_intraday_cmp_fLF')) {
    mds_ets_MNN_intraday_cmp_fLF <- read_rds(
        paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday_cmp_fLF.rds')) }

if(!is.data.table('mds_ets_MNN_intraday_cmp_fLF')) {
  mds_ets_MNN_intraday_cmp_fLF %<>% as.data.table }

mds_ets_MNN_intraday_cmp_fLF <- unique(
  mds_ets_MNN_intraday_cmp_fLF, fromLast = FALSE, by = c('index', 'model'))

rp_fLF <- mds_ets_MNN_intraday_cmp_fLF[, {
  mk.price = mk.price
  fc.price = fc.price
  .SD[, .(.N, 
          mae = MLmetrics::MAE(y_true = mk.price, y_pred = fc.price), 
          mape = MLmetrics::MAPE(y_true = mk.price, y_pred = fc.price), 
          rmse = MLmetrics::RMSE(y_true = mk.price, y_pred = fc.price), 
          smape = Metrics::smape(actual = mk.price, predicted = fc.price), 
          mse = MLmetrics::MSE(y_true = mk.price, y_pred = fc.price)), 
      by=.(model)]}][order(model), ]

## report
saveRDS(rp_fLF, paste0(.dtr, 'data/fx/USDJPY/rp_fLF.rds'))
```

```{r, warning = FALSE, message = FALSE, results='asis'}
rp_fLF <- readRDS(paste0(.dtr, 'data/fx/USDJPY/rp_fLF.rds'))

rp_tbl <- rp_fLF %>% 
  dplyr::mutate(
    mae = ifelse(
      rank(mae) <= 3, 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'grey', italic = TRUE)), 
    mape = ifelse(
      rank(mape) <= 3, 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'grey', italic = TRUE)), 
    rmse = ifelse(
      rank(rmse) <= 3, 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'grey', italic = TRUE)), 
    smape = ifelse(
      rank(smape) <= 3, 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'grey', italic = TRUE)), 
    mse = ifelse(
      rank(mse) <= 3, 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'grey', italic = TRUE))) %>% 
  kbl(caption = 'Accurcy Report (Forecasted Up to Max 1440 mins)', escape = FALSE) %>% 
  ## https://www.w3schools.com/cssref/css_colors.asp
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  column_spec(3, background = 'LightSlateGrey') %>% 
  column_spec(4, background = 'Gainsboro') %>% 
  column_spec(5, background = 'LightGray') %>% 
  column_spec(6, background = 'Gainsboro') %>% 
  column_spec(7, background = 'LightGray') %>% 
  column_spec(8, background = 'Gainsboro') %>%  
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  ##`full_width = FALSE` will auto adjust every single columns width to fit the table full width.
  scroll_box(width = '100%', fixed_thead = TRUE, height = '400px')

rp_tbl
```

*source : `r paste0(dim(rp_tbl), collapse = ' x ')`*

```{r include = FALSE}
if(exists('rp_tbl')) rm(rp_tbl)
```

from above models we know the **βest model**.

### `unique(x, fromLast = TRUE)` Dataset

Below table compares the models.

```{r, eval = FALSE}
rm(list = ls())

## report for mds_ets_MNN_intraday_cmp_fLT
if(!exists('mds_ets_MNN_intraday_cmp_fLT')) {
    mds_ets_MNN_intraday_cmp_fLT <- read_rds(
        paste0(.dtr, 'data/fx/USDJPY/mds_ets_MNN_intraday_cmp_fLT.rds')) }

if(!is.data.table('mds_ets_MNN_intraday_cmp_fLT')) {
  mds_ets_MNN_intraday_cmp_fLT %<>% as.data.table }

mds_ets_MNN_intraday_cmp_fLT <- unique(
  mds_ets_MNN_intraday_cmp_fLT, fromLast = TRUE, by = c('index', 'model'))

rp_fLT <- mds_ets_MNN_intraday_cmp_fLT[, {
  mk.price = mk.price
  fc.price = fc.price
  .SD[, .(.N, 
          mae = MLmetrics::MAE(y_true = mk.price, y_pred = fc.price), 
          mape = MLmetrics::MAPE(y_true = mk.price, y_pred = fc.price), 
          rmse = MLmetrics::RMSE(y_true = mk.price, y_pred = fc.price), 
          smape = Metrics::smape(actual = mk.price, predicted = fc.price), 
          mse = MLmetrics::MSE(y_true = mk.price, y_pred = fc.price)), 
      by=.(model)]}][order(model), ]

## report
saveRDS(rp_fLT, paste0(.dtr, 'data/fx/USDJPY/rp_fLT.rds'))
```

```{r, warning = FALSE, message = FALSE, results='asis'}
rp_fLT <- readRDS(paste0(.dtr, 'data/fx/USDJPY/rp_fLT.rds'))

rp_tbl <- rp_fLT %>% 
  dplyr::mutate(
    mae = ifelse(
      rank(mae) <= 3, 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'grey', italic = TRUE)), 
    mape = ifelse(
      rank(mape) <= 3, 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'grey', italic = TRUE)), 
    rmse = ifelse(
      rank(rmse) <= 3, 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'grey', italic = TRUE)), 
    smape = ifelse(
      rank(smape) <= 3, 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'grey', italic = TRUE)), 
    mse = ifelse(
      rank(mse) <= 3, 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'grey', italic = TRUE))) %>% 
  kbl(caption = 'Accurcy Report (Forecasted 1440 mins)', escape = FALSE) %>% 
  ## https://www.w3schools.com/cssref/css_colors.asp
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  column_spec(3, background = 'LightSlateGrey') %>% 
  column_spec(4, background = 'Gainsboro') %>% 
  column_spec(5, background = 'LightGray') %>% 
  column_spec(6, background = 'Gainsboro') %>% 
  column_spec(7, background = 'LightGray') %>% 
  column_spec(8, background = 'Gainsboro') %>%  
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  ##`full_width = FALSE` will auto adjust every single columns width to fit the table full width.
  scroll_box(width = '100%', fixed_thead = TRUE, height = '400px')

rp_tbl
```

*source : `r paste0(dim(rp_tbl), collapse = ' x ')`*

```{r include = FALSE}
if(exists('rp_tbl')) rm(rp_tbl)
```

from above models we know the **βest model**.

### Summary

```{r, warning = FALSE, message = FALSE, results = 'asis'}
rp_fLF <- rp_fLF[, arrange := 'from_first'][]
rp_fLT <- rp_fLT[, arrange := 'from_last'][]

rp <- rbindlist(list(rp_fLF, rp_fLT))
rp <- rp[, .(.id, model, arrange, N, mae, mape, rmse, smape, mse)]
rp %<>% unique

sum <- rp[mae == min(mae) | mape == min(mape) | rmse == min(rmse) | smape == min(smape) | mse == min(mse)]

sum %>% 
  dplyr::mutate(
    mae = ifelse(
      rank(mae) <= 3, 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'grey', italic = TRUE)), 
    mape = ifelse(
      rank(mape) <= 3, 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'grey', italic = TRUE)), 
    rmse = ifelse(
      rank(rmse) <= 3, 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'grey', italic = TRUE)), 
    smape = ifelse(
      rank(smape) <= 3, 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'grey', italic = TRUE)), 
    mse = ifelse(
      rank(mse) <= 3, 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'grey', italic = TRUE))) %>% 
  kbl(caption = 'Accurcy Report (Initial Stage Comparison)', escape = FALSE) %>% 
  ## https://www.w3schools.com/cssref/css_colors.asp
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  column_spec(3, background = 'grey') %>% 
  column_spec(4, background = 'LightSlateGrey') %>% 
  column_spec(5, background = 'Gainsboro') %>% 
  column_spec(6, background = 'LightGray') %>% 
  column_spec(7, background = 'Gainsboro') %>% 
  column_spec(8, background = 'LightGray') %>% 
  column_spec(9, background = 'Gainsboro') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(sum), collapse = ' x ')`*

# Conclusion

## Initial Summary

From initial stage models comparison, we know that `r unique(sum$model)[1]` and `r unique(sum$model)[2]` is the <span style='color:white; background-color:#DE5D83;'>**β**est model</span>.

## Small Adjustment

```{r, warning = FALSE, message = FALSE, results='asis'}
rp_ts <- rp[, {
    .SD[, .(model = model, 
            ts = str_detect(model, '^ts_[0-9]'), 
            arrange = arrange, 
            mae = mae, 
            mape = mape, 
            rmse = rmse, 
            smape = smape, 
            mse = mse), ]}][ts == TRUE, !('ts')]
rp_ts %<>% unique

rp_ts %>% 
  dplyr::mutate(
    mae = ifelse(
      rank(mae) <= 3, 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'grey', italic = TRUE)), 
    mape = ifelse(
      rank(mape) <= 3, 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'grey', italic = TRUE)), 
    rmse = ifelse(
      rank(rmse) <= 3, 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'grey', italic = TRUE)), 
    smape = ifelse(
      rank(smape) <= 3, 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'grey', italic = TRUE)), 
    mse = ifelse(
      rank(mse) <= 3, 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'grey', italic = TRUE))) %>% 
  kbl(caption = 'Accurcy Report (time series)', escape = FALSE) %>% 
  ## https://www.w3schools.com/cssref/css_colors.asp
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  column_spec(3, background = 'Gainsboro') %>% 
  column_spec(4, background = 'LightGray') %>% 
  column_spec(5, background = 'Gainsboro') %>% 
  column_spec(6, background = 'LightGray') %>% 
  column_spec(7, background = 'Gainsboro') %>%  
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE, height = '400px')
```

*source : `r paste0(dim(rp_ts), collapse = ' x ')`*

```{r include = FALSE}
if(exists('rp_ts')) rm(rp_ts)
```

As we can know from `ts` Here I use the <span style='color:white; background-color:#DE5D83;'>**β**est model</span> but adjust the data size to compare.

```{r, eval = FALSE}
## Get all MNN & MNZ files.
MNN_MNZ <- list.files(paste0(.dtr, 'data/fx/USDJPY/intraday/'), pattern = '^ts_ets_MNN|^ts_ets_MNZ')
fls_pth <- paste0(.dtr, 'data/fx/USDJPY/intraday/', MNN_MNZ)

## read files
ex_mds_ets_MNN_MNZ <- ldply(1:length(MNN_MNZ), function(i) {
    
    nms <- MNN_MNZ[i] %>% 
        str_replace_all('^ex_|.rds$', '') %>% 
        str_split('_|\\.') %>% 
        .[[1]]
    
    if(any(str_detect(nms, 'ets'))) {
      nms <- nms
    } else {
      nms <- c(nms[1], rep(NA, 2), nms[2:length(nms)]) }
    
    names(nms) <- c('t_series', 'model', 'sub_model', 
                    'data_min', 'fc_min', 'date')
    
    datset2 <- t(nms) %>% 
      data.frame %>% 
      mutate(model =factor(model), sub_model = factor(sub_model), 
             data_min = as.numeric(data_min), 
             fc_min = as.numeric(fc_min), date = as_date(date))
    
    datset <- read_rds(fls_pth[i])
    
    res <- tibble(datset2, datset) %>% 
      dplyr::select(index, t_series, model, sub_model, data_min, 
                    fc_min, date, mk.price, fc.price)
    res <- res[!is.na('mk.price'),]
    cat(nms, '\n')
    
    return(res)
    
}) %>% 
  as_tibble

saveRDS(ex_mds_ets_MNN_MNZ, 
         paste0(.dtr, 'data/fx/USDJPY/intraday/ex_mds_ets_MNN_MNZ.rds'))

rm(list = ls())

## MNN & MNZ ets models
if(!exists('ex_mds_ets_MNN_MNZ')) {
  ex_mds_ets_MNN_MNZ <- read_rds(
    paste0(.dtr, 'data/fx/USDJPY/intraday/ex_mds_ets_MNN_MNZ.rds')) }

ex_mds_ets_MNN_MNZ_cmp <- ex_mds_ets_MNN_MNZ %>% 
    tidyr::unite(model, t_series:fc_min) %>%  #different with mds_ts_cmp
    as.data.table %>% 
    .[, .(index, model, mk.price, fc.price)]

ex_mds_ets_MNN_MNZ_cmp <- unique(
  ex_mds_ets_MNN_MNZ_cmp[, .(index, model, mk.price, fc.price)])

## save dataset in data.table format
saveRDS(ex_mds_ets_MNN_MNZ_cmp, 
        paste0(.dtr, 'data/fx/USDJPY/intraday/ex_mds_ets_MNN_MNZ_cmp.rds'))
```

<span style='color:green'>**MNN_MNZ_rp_fLF**</span>

```{r, eval = FALSE}
rm(list = ls())

## report for ex_mds_ets_MNN_MNZ_cmp
if(!exists('ex_mds_ets_MNN_MNZ_cmp')) {
    ex_mds_ets_MNN_MNZ_cmp <- read_rds(
        paste0(.dtr, 'data/fx/USDJPY/intraday/ex_mds_ets_MNN_MNZ_cmp.rds')) }

if(!is.data.table('ex_mds_ets_MNN_MNZ_cmp')) {
  ex_mds_ets_MNN_MNZ_cmp %<>% as.data.table }

ex_mds_ets_MNN_MNZ_cmp <- unique(
  ex_mds_ets_MNN_MNZ_cmp, fromLast = FALSE, by = c('index', 'model')) %>% 
  na.omit

MNN_MNZ_rp_fLF <- ex_mds_ets_MNN_MNZ_cmp[, {
  mk.price = mk.price
  fc.price = fc.price
  .SD[, .(.N, 
          mae = MLmetrics::MAE(y_true = mk.price, y_pred = fc.price), 
          mape = MLmetrics::MAPE(y_true = mk.price, y_pred = fc.price), 
          rmse = MLmetrics::RMSE(y_true = mk.price, y_pred = fc.price), 
          smape = Metrics::smape(actual = mk.price, predicted = fc.price), 
          mse = MLmetrics::MSE(y_true = mk.price, y_pred = fc.price)), 
      by=.(model)]}][order(model), ]

rm(ex_mds_ets_MNN_MNZ_cmp)

## report
saveRDS(MNN_MNZ_rp_fLF, paste0(.dtr, 'data/fx/USDJPY/intraday/MNN_MNZ_rp_fLF.rds'))
```

<span style='color:green'>**MNN_MNZ_rp_fLT**</span>

```{r, eval = FALSE}
rm(list = ls())

## report for ex_mds_ets_MNN_MNZ_cmp
if(!exists('ex_mds_ets_MNN_MNZ_cmp')) {
    ex_mds_ets_MNN_MNZ_cmp <- read_rds(
        paste0(.dtr, 'data/fx/USDJPY/intraday/ex_mds_ets_MNN_MNZ_cmp.rds')) }

if(!is.data.table('ex_mds_ets_MNN_MNZ_cmp')) {
  ex_mds_ets_MNN_MNZ_cmp %<>% as.data.table }

ex_mds_ets_MNN_MNZ_cmp <- unique(
  ex_mds_ets_MNN_MNZ_cmp, fromLast = TRUE, by = c('index', 'model')) %>% 
  na.omit

MNN_MNZ_rp_fLT <- ex_mds_ets_MNN_MNZ_cmp[, {
  mk.price = mk.price
  fc.price = fc.price
  .SD[, .(.N, 
          mae = MLmetrics::MAE(y_true = mk.price, y_pred = fc.price), 
          mape = MLmetrics::MAPE(y_true = mk.price, y_pred = fc.price), 
          rmse = MLmetrics::RMSE(y_true = mk.price, y_pred = fc.price), 
          smape = Metrics::smape(actual = mk.price, predicted = fc.price), 
          mse = MLmetrics::MSE(y_true = mk.price, y_pred = fc.price)), 
      by=.(model)]}][order(model), ]

rm(ex_mds_ets_MNN_MNZ_cmp)

## report
saveRDS(MNN_MNZ_rp_fLT, paste0(.dtr, 'data/fx/USDJPY/intraday/MNN_MNZ_rp_fLT.rds'))
```

```{r, warning = FALSE, message = FALSE, results = 'asis'}
## report for MNN_MNZ_rp_fLF
if(!exists('MNN_MNZ_rp_fLF')) {
    MNN_MNZ_rp_fLF <- read_rds(
        paste0(.dtr, 'data/fx/USDJPY/intraday/MNN_MNZ_rp_fLF.rds')) }

## report for MNN_MNZ_rp_fLT
if(!exists('MNN_MNZ_rp_fLT')) {
    MNN_MNZ_rp_fLT <- read_rds(
        paste0(.dtr, 'data/fx/USDJPY/intraday/MNN_MNZ_rp_fLT.rds')) }

MNN_MNZ_rp_fLF <- MNN_MNZ_rp_fLF[, arrange := 'from_first'][]
MNN_MNZ_rp_fLT <- MNN_MNZ_rp_fLT[, arrange := 'from_last'][]

rp <- rbindlist(list(MNN_MNZ_rp_fLF, MNN_MNZ_rp_fLT))
rp <- rp[, .(model, arrange, N, mae, mape, rmse, smape, mse)]
rp %<>% unique

rm(MNN_MNZ_rp_fLF, MNN_MNZ_rp_fLT)
```

```{r, warning = FALSE, message = FALSE, results = 'asis'}
rp %>% 
  dplyr::mutate(
    mae = ifelse(
      rank(mae) <= 3, 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'grey', italic = TRUE)), 
    mape = ifelse(
      rank(mape) <= 3, 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'grey', italic = TRUE)), 
    rmse = ifelse(
      rank(rmse) <= 3, 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'grey', italic = TRUE)), 
    smape = ifelse(
      rank(smape) <= 3, 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'grey', italic = TRUE)), 
    mse = ifelse(
      rank(mse) <= 3, 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'grey', italic = TRUE))) %>% 
  kbl(caption = 'Accurcy Report (MNN & MNZ ETS Models)', escape = FALSE) %>% 
  ## https://www.w3schools.com/cssref/css_colors.asp
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  column_spec(3, background = 'LightSlateGrey') %>% 
  column_spec(4, background = 'LightGray') %>% 
  column_spec(5, background = 'Gainsboro') %>% 
  column_spec(6, background = 'LightGray') %>% 
  column_spec(7, background = 'Gainsboro') %>% 
  column_spec(8, background = 'LightGray') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE, height = '400px')
```

*source : `r paste0(dim(rp), collapse = ' x ')`*

from above models we know the **βest model**.

```{r, warning = FALSE, message = FALSE, results = 'asis'}
sum <- rp[mae == min(mae) | mape == min(mape) | rmse == min(rmse) | smape == min(smape) | mse == min(mse)]

sum %>% 
  dplyr::mutate(
    mae = ifelse(
      rank(mae) <= 3, 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mae, 7), ' (rank: ', sprintf('%1.f', rank(mae)), ')'), 
        color = 'grey', italic = TRUE)), 
    mape = ifelse(
      rank(mape) <= 3, 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mape, 7), ' (rank: ', sprintf('%1.f', rank(mape)), ')'), 
        color = 'grey', italic = TRUE)), 
    rmse = ifelse(
      rank(rmse) <= 3, 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(rmse, 7), ' (rank: ', sprintf('%1.f', rank(rmse)), ')'), 
        color = 'grey', italic = TRUE)), 
    smape = ifelse(
      rank(smape) <= 3, 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(smape, 7), ' (rank: ', sprintf('%1.f', rank(smape)), ')'), 
        color = 'grey', italic = TRUE)), 
    mse = ifelse(
      rank(mse) <= 3, 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'darkgoldenrod', bold = TRUE), 
      cell_spec(
        paste0(round(mse, 7), ' (rank: ', sprintf('%1.f', rank(mse)), ')'), 
        color = 'grey', italic = TRUE))) %>% 
  kbl(caption = 'Accurcy Report (Final Stage Comparison)', escape = FALSE) %>% 
  ## https://www.w3schools.com/cssref/css_colors.asp
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue') %>% 
  column_spec(2, background = '#556DAC') %>% 
  column_spec(3, background = 'LightSlateGrey') %>% 
  column_spec(4, background = 'LightGray') %>% 
  column_spec(5, background = 'Gainsboro') %>% 
  column_spec(6, background = 'LightGray') %>% 
  column_spec(7, background = 'Gainsboro') %>% 
  column_spec(8, background = 'LightGray') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  kable_material(full_width = FALSE) %>% 
  scroll_box(width = '100%', fixed_thead = TRUE)
```

*source : `r paste0(dim(sum), collapse = ' x ')`*

## Final Conclude

From final stage models comparison, we know that `r unique(sum$model)[1]` and `r unique(sum$model)[2]` is the <span style='color:white; background-color:#DE5D83;'>**β**est model</span>.

## Future Studies

Next papers will compare `tbats`, `midas`, `sarimax` etc.

```{r opt, echo = FALSE}
## Set options back to original options
options(warn = 0)
```

# Appendix

## Blooper

There has a small mistake in previous paper [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part I)*</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT-RV1) but doesn't affect since I only want to compare the models and here I use the same `MNN` model and filter `unique(fromLast = FALSE)` and `unique(fromLast = TRUE)`.

## Documenting File Creation 

It's useful to record some information about how your file was created.

- File creation date: 2021-02-03
- File latest updated date: `r today('Asia/Tokyo')`
- `r R.version.string`
- R version (short form): `r getRversion()`
- [**rmarkdown** package](https://github.com/rstudio/rmarkdown) version: `r packageVersion('rmarkdown')`
- File version: 1.0.0
- Author Profile: [®γσ, Eng Lian Hu](https://github.com/scibrokes/owner)
- GitHub: [Source Code](https://github.com/englianhu/binary.com-interview-question)
- Additional session information:

```{r info, warning = FALSE, results = 'asis'}
suppressMessages(require('dplyr', quietly = TRUE))
suppressMessages(require('magrittr', quietly = TRUE))
suppressMessages(require('formattable', quietly = TRUE))
suppressMessages(require('knitr', quietly = TRUE))
suppressMessages(require('kableExtra', quietly = TRUE))

sys1 <- devtools::session_info()$platform %>% 
  unlist %>% data.frame(Category = names(.), session_info = .)
rownames(sys1) <- NULL

sys2 <- data.frame(Sys.info()) %>% 
  dplyr::mutate(Category = rownames(.)) %>% .[2:1]
names(sys2)[2] <- c('Sys.info')
rownames(sys2) <- NULL

if (nrow(sys1) == 9 & nrow(sys2) == 8) {
  sys2 %<>% rbind(., data.frame(
  Category = 'Current time', 
  Sys.info = paste(as.character(lubridate::now('Asia/Tokyo')), 'JST🗾')))
} else {
  sys1 %<>% rbind(., data.frame(
  Category = 'Current time', 
  session_info = paste(as.character(lubridate::now('Asia/Tokyo')), 'JST🗾')))
}

sys <- cbind(sys1, sys2) %>% 
  kbl(caption = 'Additional session information:') %>% 
  kable_styling(bootstrap_options = c('striped', 'hover', 'condensed', 'responsive')) %>% 
  row_spec(0, background = 'DimGrey', color = 'yellow') %>% 
  column_spec(1, background = 'CornflowerBlue', color = 'red') %>% 
  column_spec(2, background = 'grey', color = 'black') %>% 
  column_spec(3, background = 'CornflowerBlue', color = 'blue') %>% 
  column_spec(4, background = 'grey', color = 'white') %>% 
  row_spec(9, bold = T, color = 'yellow', background = '#D7261E')

rm(sys1, sys2)
sys
```

## Reference

01. [<span style='color:#DE5D83; background-color:black;'>Deriv.com</span> - Interday High Frequency Trading Models Comparison <span style='color:red'>(Blooper)</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT)
02. [<span style='color:#DE5D83; background-color:black;'>Deriv.com</span> - Interday High Frequency Trading Models Comparison <span style='color:RoyalBlue'>Review (Part I)</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT-RV1) (in RPubs.com)
03. [<span style='color:#DE5D83; background-color:black;'>Deriv.com</span> - Interday High Frequency Trading Models Comparison <span style='color:RoyalBlue'>Review (Part I)</span>](https://beta.rstudioconnect.com/content/16240/binary-Q1Inter-HFT-RV1.html) (in RStudioConnect.com)
04. [binary.com 面试试题 I - GARCH模型中的`ARCH in Mean`](https://rpubs.com/englianhu/binary-Q1-archm)
05. [binary.com 面试试题 I - GARCH模型中的`ARIMA(p,d,q)`参数最优化](https://rpubs.com/englianhu/binary-Q1FiGJRGARCH)
06. [Forecasting: Principles and Practice](https://otexts.com/fpp3)
07. [Tableau 100 Color Palettes](https://public.tableau.com/en-us/gallery/100-color-palettes)

<br>

---

<br>

<span style='color:RoyalBlue'>**Powered by - Copyright® Intellectual Property Rights of <img src='www/scb-logo3rs.jpg' width='18'> [Sςιβrοκεrs Trαdιηg ®️](http://www.scibrokes.com) 経営企業**</span>
