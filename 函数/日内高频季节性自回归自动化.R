æ—¥å†…é«˜é¢‘å­£èŠ‚æ€§è‡ªå›å½’è‡ªåŠ¨åŒ– <- function(
    ## å‡½æ•° ----
    ## å’±ä»¬äºšæ´²ä¸–è¢­åˆ¶é“æ•™å¾’èµ¢å®¶é»„æ°æ±Ÿå¤å ‚è”å¯Œå’Œå®¶çœ·äº²å±éƒ½ä¸å¯ä»¥æ­»ï¼Œå­¦æœ¯ä¼˜å…ˆï¼Œæ‹¯æ•‘äºšæ´²äºº ====
    æ—¶é—´ç´¢å¼•, æ ·æœ¬, .èœ€é“ = NULL, æ–‡ä»¶å = 'æ—¥å†…é«˜é¢‘å­£èŠ‚æ€§è‡ªå›å½’', æ•°æ®é‡, 
    é¢‘ç‡ = 1, é¢„æµ‹æ—¶é—´å•ä½ = 1, .æ¨¡å‹é€‰é¡¹ = .æ¨¡å‹é€‰é¡¹, 
    .å·®åˆ†é˜¶æ•° = .å·®åˆ†é˜¶æ•°, .å­£èŠ‚æ€§å·®åˆ†é˜¶æ•° = .å­£èŠ‚æ€§å·®åˆ†é˜¶æ•°, 
    .æ—¶åºè§„å¾‹ = .æ—¶åºè§„å¾‹, .å­£èŠ‚æ€§è§„å¾‹å‚æ•° = .å­£èŠ‚æ€§è§„å¾‹å‚æ•°, é™æ€ä¸å¦ = 'å‰', 
    å­£èŠ‚æ€§ä¸å¦ = 'å‹¾', ä¿¡æ¯é‡å‡†åˆ™ = c('aicc', 'aic', 'bic'), 
    é€æ­¥ç²¾åŒ–ä¸å¦ = 'å‹¾', é€æ­¥ç²¾åŒ–é‡ = 94, è®°è½½è‡ªå›å½’ä¸å¦ = 'å‰', 
    è¿‘ä¼¼å€¼ä¸å¦ = 'å‹¾', è®¡ç­–è°‹ç•¥ = 'å†‡', çœç•¥ = 'å†‡', 
    ## ä»£ç ä¸­xregä½œä¸º [å…¬å¼] ã€‚xregå¯ä»¥æŒ‡å®šå¤šç»„ç›¸å…³åºåˆ—ï¼Œ
    ##   ä¹Ÿå°±æ˜¯è¯´åŠ¨æ€å›å½’å°±æ˜¯å¤šå…ƒå›å½’ã€‚
    ## Dynamic Harmonic Regression
    ## ä½¿ç”¨FTï¼ˆå‚…é‡Œå¶ï¼‰åºåˆ—ä½œä¸ºxregã€‚æ¨¡å‹æ‹Ÿåˆæ—¶ä¸æŒ‡å®šseasonalï¼Œ
    ##   åœ¨é¢„æµ‹æ—¶åŠ å…¥å‘¨æœŸæ€§çš„xregï¼ˆåŠ¿å¤´/è¶‹åŠ¿/æ°”åŠ¿ï¼‰ã€‚
    ## [Rè¯­è¨€æ—¶é—´åºåˆ—åˆ†æï¼ˆé¢„æµ‹ï¼‰](https://zhuanlan.zhihu.com/p/29755934)
    è¶‹åŠ¿ = 'å†‡', æµ‹è¯• = c('kpss', 'adf', 'pp'), æµ‹è¯•å‚æ•° = list(), 
    å­£èŠ‚æ€§æµ‹è¯• = c('seas', 'ocsb', 'hegy', 'ch'), å­£èŠ‚æ€§æµ‹è¯•å‚æ•° = list(), 
    å…è®¸æˆªè·ä¸å¦ = 'å‹¾', å…è®¸å‡å€¼ä¸å¦ = 'å‹¾', ç›¸å…³ç³»æ•° = 'å†‡', 
    åå·®è°ƒæ•´ä¸å¦ = 'å‰', å¤šç®¡é½ä¸‹ä¸å¦ = 'å‰', æ ¸å¿ƒé‡ = 2, åˆ—å° = 'å‹¾') {
  
  # èµ‹è¯— ----
  cat('\n=== å­™ä¸­å±±è’‹ä»‹çŸ³/æ¯›æ³½ä¸œï¼Œå¤§ç§¦èµ‹ï¼Œé»„åŸ”å†›æ ¡ï¼Œä¸­ç§‘çº¢æ——Asianuxå…µå·¥å‚ ===') 
  cat('\n======== ä¸­ç§‘çº¢æ——ï¼Œé™¤å·«ç ¸å€­ ========')
  cat('\n======== ç§¦çš‡å¬´æ”¿ï¼Œç¬‘å‚²æ±Ÿæ¹– ========')
  cat('\n======== ä¸‰å†›æœªåŠ¨ï¼Œç²®è‰å…ˆè¡Œ ========')
  cat('\n======== ä¸€å¸¦ä¸€è·¯ï¼Œæ³›äºšé«˜é“ ========')
  cat('\n======== ä¸å¿˜åˆå¿ƒï¼Œæ–¹å¾—å§‹ç»ˆ ========')
  cat('\n========                 ========')
  cat('\n======== åƒå¤ä¸€å¸ï¼Œç§¦çš‡å¬´æ”¿ ========')
  cat('\n======== æ•Œåœ¨ä¸œç›Ÿï¼Œç»Ÿä¸€äºšæ´² ========')
  cat('\n======== å’¸é˜³å‡ºå‘ï¼Œè¥¿å¾æ¬§é ========')
  cat('\n======== é’å‡ºäºè“ï¼Œè€Œèƒœäºè“ ========')
  cat('\n======== çº¢å‡ºäºé’ï¼Œæ›´èƒœäºæ¸… ========')
  cat('\n======== ä¸­ç§‘çº¢æ——ï¼Œæ›´èƒœè‹±è’™ ========')
  cat('\n======== æ¨ªè·¨ä¸ƒæ´²ï¼Œç§¦ç­å…­æ´² ========')
  cat('\n======== å²æ— å‰ä¾‹ï¼Œä¸€ç»Ÿå¤©ä¸‹ ========')
  cat('\n======== ä¸‰å†›æœªåŠ¨ï¼Œç²®è‰å…ˆè¡Œ ========')
  cat('\n======== ä¸€å¸¦ä¸€è·¯ï¼Œæ³›äºšé«˜é“ ========')
  cat('\n======== ä¸å¿˜åˆå¿ƒï¼Œæ”¾å¾—å§‹ç»ˆ ========\n')
  
  ## è®¾ç½® ----
  options(digits = 22)
  require('tidyft', quietly = TRUE)
  require('forecast', quietly = TRUE)
  require('Ipaper', quietly = TRUE)
  conflict_prefer('llply', 'Ipaper', quiet = TRUE)
  conflict_prefer('mutate_dt', 'tidyft', quiet = TRUE)
  conflict_prefer('rename_dt', 'tidyft', quiet = TRUE)
  conflict_prefer('select_dt', 'tidyft', quiet = TRUE)
  
  if (!'data.table' %in% class(æ ·æœ¬)) æ ·æœ¬ %<>% as.data.table
  
  if (!exists('.èœ€é“') || is.null(.èœ€é“)) {
    .èœ€é“ <- getwd() |> 
      {\(.) str_split(., '/')}() |> 
      {\(.) c('/', .[[1]][2:5])}() |> 
      {\(.) c(., 'binary.com-interview-question-data/')}() |> 
      {\(.) paste(., collapse = '/')}() |> 
      {\(.) substring(., 2)}()
  }
  .èœ€é“ä»“åº“ <- paste0(.èœ€é“, 'è¯¸å­ç™¾å®¶å­¦åºœ/fx/USDJPY/ä»“åº“/')
  
  #if (!is.numeric(.å·®åˆ†é˜¶æ•°) && length(.å·®åˆ†é˜¶æ•°) != 1) 
  #  stop(".å·®åˆ†é˜¶æ•° = 0 æˆ– 1 æˆ– 2")
  #if (!is.numeric(.å­£èŠ‚æ€§å·®åˆ†é˜¶æ•°) && length(.å­£èŠ‚æ€§å·®åˆ†é˜¶æ•°) != 1) 
  #  stop(".å­£èŠ‚æ€§å·®åˆ†é˜¶æ•° = 0 æˆ– 1")
  #if (!é™æ€ä¸å¦ %in% c('å‹¾', 'å‰')) stop("é™æ€ä¸å¦ = 'å‹¾' æˆ– 'å‰'")
  #if (!å­£èŠ‚æ€§ä¸å¦ %in% c('å‹¾', 'å‰')) stop("å­£èŠ‚æ€§ä¸å¦ = 'å‹¾' æˆ– 'å‰'")
  #if (!ä¿¡æ¯é‡å‡†åˆ™ %in% c('aicc', 'aic', 'bic')) 
  #  stop("ä¿¡æ¯é‡å‡†åˆ™ = 'aicc' æˆ– 'aic' æˆ– 'bic'")
  #if (!æµ‹è¯• %in% c('kpss', 'adf', 'pp')) 
  #  stop("æµ‹è¯• = 'kpss' æˆ– 'adf' æˆ– 'pp'")
  #if (!å­£èŠ‚æ€§æµ‹è¯• %in% c('seas', 'ocsb', 'hegy', 'ch'))
  #  stop("å­£èŠ‚æ€§æµ‹è¯• = 'seas' æˆ– 'ocsb' æˆ– 'hegy' æˆ– 'ch'")
  #if (!é€æ­¥ç²¾åŒ–ä¸å¦ %in% c('å‹¾', 'å‰')) stop("é€æ­¥ç²¾åŒ–ä¸å¦ = 'å‹¾' æˆ– 'å‰'")
  #if (!è®°è½½è‡ªå›å½’ä¸å¦ %in% c('å‹¾', 'å‰')) stop("è®°è½½è‡ªå›å½’ä¸å¦ = 'å‹¾' æˆ– 'å‰'")
  #if (!å…è®¸æˆªè·ä¸å¦ %in% c('å‹¾', 'å‰')) stop("å…è®¸æˆªè·ä¸å¦ = 'å‹¾' æˆ– 'å‰'")
  #if (!å…è®¸å‡å€¼ä¸å¦ %in% c('å‹¾', 'å‰')) stop("åŒ…å«å‡å€¼ä¸å¦ = 'å‹¾' æˆ– 'å‰'")
  #if (!åå·®è°ƒæ•´ä¸å¦ %in% c('å‹¾', 'å‰')) stop("åå·®è°ƒæ•´ä¸å¦ = 'å‹¾' æˆ– 'å‰'")
  #if (!å¤šç®¡é½ä¸‹ä¸å¦ %in% c('å‹¾', 'å‰')) stop("å¤šç®¡é½ä¸‹ä¸å¦ = 'å‹¾' æˆ– 'å‰'")
  #if (!åˆ—å° %in% c('å‹¾', 'å‰')) stop("åˆ—å° = 'å‹¾' æˆ– 'å‰'")
  
  é™æ€ä¸å¦ <- ifelse2(é™æ€ä¸å¦ == 'å‹¾', TRUE, FALSE)
  å­£èŠ‚æ€§ä¸å¦ <- ifelse2(å­£èŠ‚æ€§ä¸å¦ == 'å‹¾', TRUE, FALSE)
  é€æ­¥ç²¾åŒ–ä¸å¦ <- ifelse2(é€æ­¥ç²¾åŒ–ä¸å¦ == 'å‹¾', TRUE, FALSE)
  è®°è½½è‡ªå›å½’ä¸å¦ <- ifelse2(è®°è½½è‡ªå›å½’ä¸å¦ == 'å‹¾', TRUE, FALSE)
  è®¡ç­–è°‹ç•¥ <- ifelse2(è®¡ç­–è°‹ç•¥ == 'å†‡', NULL, è®¡ç­–è°‹ç•¥)
  çœç•¥ <- ifelse2(çœç•¥ == 'å†‡', NULL, çœç•¥)
  è¶‹åŠ¿ <- ifelse2(è¶‹åŠ¿ == 'å†‡', NULL, è¶‹åŠ¿)
  å…è®¸æˆªè·ä¸å¦ <- ifelse2(å…è®¸æˆªè·ä¸å¦ == 'å‹¾', TRUE, FALSE)
  å…è®¸å‡å€¼ä¸å¦ <- ifelse2(å…è®¸å‡å€¼ä¸å¦ == 'å‹¾', TRUE, FALSE)
  ç›¸å…³ç³»æ•° <- ifelse2(ç›¸å…³ç³»æ•° == 'å†‡', NULL, ç›¸å…³ç³»æ•°)
  åå·®è°ƒæ•´ä¸å¦ <- ifelse2(åå·®è°ƒæ•´ä¸å¦ == 'å‹¾', TRUE, FALSE)
  å¤šç®¡é½ä¸‹ä¸å¦ <- ifelse2(å¤šç®¡é½ä¸‹ä¸å¦ == 'å‹¾', TRUE, FALSE)
  
  ## æ’ç‰ˆ ----
  ## å‡è®¾æ•°æ®é‡ = 1200åˆ†é’Ÿ
  ## é¢‘ç‡ = 1200
  ## 20å°æ—¶ä¸€å‘¨æœŸï¼ˆ1200åˆ†é’Ÿå¾ªç¯1æ¬¡ï¼‰
  ## 10å°æ—¶ä¸€å‘¨æœŸï¼ˆ600åˆ†é’Ÿå¾ªç¯2æ¬¡ï¼‰
  å¾ªç¯å‘¨æœŸ <- æ•°æ®é‡/é¢‘ç‡
  è¿­ä»£åŸºå‡† <- æ ·æœ¬[æ—¥æœŸ %chin% æ—¶é—´ç´¢å¼•]$åºåˆ—
  
  ## è¿­ä»£è¿ç®— ----
  æˆå“ <- llply(è¿­ä»£åŸºå‡†, function(è¿­æ•°ç”²) {
    
    è¿­æ•°åˆ—è¡¨ <- (è¿­æ•°ç”² - æ•°æ®é‡):(è¿­æ•°ç”² - 1)
    åŸ¹è®­æ ·æœ¬ <- æ ·æœ¬[åºåˆ— %chin% è¿­æ•°åˆ—è¡¨]
    é¢„æµ‹æ ·æœ¬ <- æ ·æœ¬[åºåˆ— == åŸ¹è®­æ ·æœ¬[.N]$åºåˆ— + é¢„æµ‹æ—¶é—´å•ä½]
    
    if (åˆ—å° == 'å‹¾') {
      cat('\n=== å’±ä»¬äºšæ´²ä¸–è¢­åˆ¶é“æ•™å¾’èµ¢å®¶é»„æ°æ±Ÿå¤å ‚è”å¯Œå’Œå®¶çœ·äº²å±éƒ½ä¸å¯ä»¥æ­»ï¼Œå­¦æœ¯ä¼˜å…ˆï¼Œæ‹¯æ•‘äºšæ´²äºº ===\n')
      cat('åŸ¹è®­æ ·æœ¬[', 'æ•°æ®é‡ï¼š', æ•°æ®é‡, 'é¢‘ç‡ï¼š', é¢‘ç‡, '-', 
          'åŸ¹è®­æ ·æœ¬æœ€ç»ˆåºåˆ—å·ï¼š', åŸ¹è®­æ ·æœ¬[.N]$åºåˆ—, ']\n')
      print(åŸ¹è®­æ ·æœ¬)
      
      cat('\n--- ç§¦å­å…¬ğŸŒŸé™ˆç¥¯ç¦„ï¼Œå•†é…å˜æ³•ï¼Œé“²é™¤å·«è£”ï¼Œæ¨ç¿»é©¬æ¥å›æ•™å®¦å®˜å·«å¸ˆæ”¿æƒï¼Œåƒå¤ä¸€å¸ã€‚---\n')
      cat('é¢„æµ‹æ ·æœ¬[', 'æ•°æ®é‡ï¼š', æ•°æ®é‡, 'é¢‘ç‡ï¼š', é¢‘ç‡, '-', 
          'é¢„æµ‹æ ·æœ¬åºåˆ—å·ï¼š', è¿­æ•°ç”², ']\n')
      print(é¢„æµ‹æ ·æœ¬)
    }
    
    ## å»ºç«‹å­£èŠ‚æ€§æ¨¡å‹ ----
    # å­£å›å½’ <- åŸ¹è®­æ ·æœ¬[, .(å¹´æœˆæ—¥æ—¶åˆ†, é—­å¸‚ä»·)] %>% 
    #   as.matrix %>% 
    #   tk_ts(frequency = é¢‘ç‡)
    ## 
    ## åœ¨tså’Œxtså’Œmatrixæ ¼å¼ä¸Šä½¿ç”¨auto.arima
    ## https://github.com/englianhu/binary.com-interview-question/issues/8#issue-1515678585
    cat('å¼€å§‹å»ºç«‹å­£èŠ‚æ€§æ¨¡å‹\n')
    å­£å›å½’ <- åŸ¹è®­æ ·æœ¬$é—­å¸‚ä»· |> 
      {\(.) matrix(., dimnames = list(åŸ¹è®­æ ·æœ¬$å¹´æœˆæ—¥æ—¶åˆ†, 'é—­å¸‚ä»·'))}() |> 
      {\(.) tk_ts(., frequency = é¢‘ç‡)}()
    rownames(å­£å›å½’) <- åŸ¹è®­æ ·æœ¬$å¹´æœˆæ—¥æ—¶åˆ†
    cat('å»ºç«‹å­£èŠ‚æ€§æ¨¡å‹å®Œæ¯•\n')
    
    è¿‘ä¼¼å€¼ä¸å¦ <- ifelse2(è¿‘ä¼¼å€¼ä¸å¦ == 'å‹¾', (length(å­£å›å½’) > 150 | frequency(å­£å›å½’) > 12), FALSE)
    
    ## è¿ç®—å­£å›å½’ ----
    cat('å¼€å§‹è¿ç®—å­£å›å½’\n')
    åŠæˆå“ <- tryCatch({
      auto.arima(
        å­£å›å½’, d = .å·®åˆ†é˜¶æ•°, D = .å­£èŠ‚æ€§å·®åˆ†é˜¶æ•°, stationary = é™æ€ä¸å¦, 
        seasonal = å­£èŠ‚æ€§ä¸å¦, ic = ä¿¡æ¯é‡å‡†åˆ™, stepwise = é€æ­¥ç²¾åŒ–ä¸å¦, 
        nmodels = é€æ­¥ç²¾åŒ–é‡, trace = è®°è½½è‡ªå›å½’ä¸å¦, approximation = è¿‘ä¼¼å€¼ä¸å¦, 
        method = è®¡ç­–è°‹ç•¥, truncate = çœç•¥, xreg = è¶‹åŠ¿, test = æµ‹è¯•, 
        test.args = æµ‹è¯•å‚æ•°, allowdrift = å…è®¸æˆªè·ä¸å¦, 
        seasonal.test = å­£èŠ‚æ€§æµ‹è¯•, seasonal.test.args = å­£èŠ‚æ€§æµ‹è¯•å‚æ•°, 
        allowmean = å…è®¸å‡å€¼ä¸å¦, lambda = ç›¸å…³ç³»æ•°, 
        #lambda = åšå…‹æ–¯è€ƒå…‹æ–¯å˜æ¢, 
        biasadj = åå·®è°ƒæ•´ä¸å¦, parallel = å¤šç®¡é½ä¸‹ä¸å¦, num.cores = æ ¸å¿ƒé‡)
      }, é”™è¯¯ä¿¡æ¯ = function(é”™è¯¯ä¿¡æ¯å‚æ•°) NULL)
    cat('è¿ç®—å®Œæ¯•å­£å›å½’\n')
    
    ## è¿ç®—é¢„æµ‹æ±‡ä»· ----
    cat('å¼€å§‹è¿ç®—é¢„æµ‹æ±‡ä»·\n')
    é¢„æµ‹æ±‡ä»· <- åŠæˆå“ |> 
      forecast::forecast(h = é¢„æµ‹æ—¶é—´å•ä½)
    cat('è¿ç®—å®Œæ¯•é¢„æµ‹æ±‡ä»·\n')
    
    ## æ•´é¡¿é¢„æµ‹æ±‡ä»· ----
    cat('å¼€å§‹æ•´é¡¿é¢„æµ‹æ±‡ä»·\n')
    åŠæˆå“ <- é¢„æµ‹æ ·æœ¬ |> 
      {\(.) mutate_dt(., å¸‚åœºä»· = é—­å¸‚ä»·, 
                      é¢„æµ‹ä»· = as_tibble(é¢„æµ‹æ±‡ä»·)$`Point Forecast`)}() |> 
      {\(.) select_dt(., å¹´æœˆæ—¥æ—¶åˆ†, å¸‚åœºä»·, é¢„æµ‹ä»·)}()
    cat('æ•´é¡¿å®Œæ¯•é¢„æµ‹æ±‡ä»·\n')
    
    ## å‘½åç»Ÿè®¡æ¨¡å‹ ----
    cat('å¼€å§‹å‘½åç»Ÿè®¡æ¨¡å‹\n')
    æ¨¡å‹åç§° <- paste0(
      'è‡ªåŠ¨å­£å›å½’_å·®åˆ†é˜¶æ•°_', .å·®åˆ†é˜¶æ•°, '_å­£èŠ‚æ€§å·®åˆ†é˜¶æ•°_', .å­£èŠ‚æ€§å·®åˆ†é˜¶æ•°, 
      '_é™æ€ä¸å¦_', é™æ€ä¸å¦, '_å­£èŠ‚æ€§ä¸å¦_', å­£èŠ‚æ€§ä¸å¦, 
      '_ä¿¡æ¯é‡å‡†åˆ™_', ä¿¡æ¯é‡å‡†åˆ™, '_é€æ­¥ç²¾åŒ–ä¸å¦_', é€æ­¥ç²¾åŒ–ä¸å¦, 
      '_é€æ­¥ç²¾åŒ–é‡_', é€æ­¥ç²¾åŒ–é‡, '_è®°è½½è‡ªå›å½’ä¸å¦_', è®°è½½è‡ªå›å½’ä¸å¦, 
      '_è®¡ç­–è°‹ç•¥_', è®¡ç­–è°‹ç•¥, '_çœç•¥_', çœç•¥, '_è¶‹åŠ¿_', è¶‹åŠ¿, '_æµ‹è¯•_', æµ‹è¯•, 
      '_å­£èŠ‚æ€§æµ‹è¯•_', å­£èŠ‚æ€§æµ‹è¯•, '_å…è®¸å‡å€¼ä¸å¦_', å…è®¸å‡å€¼ä¸å¦, 
      '_ç›¸å…³ç³»æ•°_', ç›¸å…³ç³»æ•°, '_åå·®è°ƒæ•´ä¸å¦_', åå·®è°ƒæ•´ä¸å¦, '_æ•°æ®é‡', æ•°æ®é‡, 
      '_é¢‘ç‡', é¢‘ç‡, '_é¢„æµ‹æ—¶é—´å•ä½', é¢„æµ‹æ—¶é—´å•ä½, 
      '_', åŠæˆå“$å¹´æœˆæ—¥æ—¶åˆ†, 'CST.rds')
    cat('å‘½åç»Ÿè®¡æ¨¡å‹å®Œæ¯•\n')
    
    cat('å¼€å§‹åˆ—å°åŠæˆå“\n')
    if (åˆ—å° == 'å‹¾') {
      cat('\n--- ç§¦å­å…¬ğŸŒŸé™ˆç¥¯ç¦„ï¼Œå•†é…å˜æ³•ï¼Œé“²é™¤å·«è£”ï¼Œæ¨ç¿»é©¬æ¥å›æ•™å®¦å®˜å·«å¸ˆæ”¿æƒï¼Œåƒå¤ä¸€å¸ã€‚---\n')
      cat('é¢„æµ‹æ ·æœ¬[', 'æ•°æ®é‡ï¼š', æ•°æ®é‡, 'é¢‘ç‡ï¼š', é¢‘ç‡, '-', 
          'é¢„æµ‹æ•°æ®åºåˆ—å·ï¼š', è¿­æ•°ç”², ']\n')
      print(åŠæˆå“)
    }
    cat('åˆ—å°åŠæˆå“å®Œæ¯•\n')
    
    ## å‚¨å­˜åŠæˆå“ ----
    cat('å¼€å§‹å‚¨å­˜åŠæˆå“\n')
    if (!dir.exists(paste0(.èœ€é“ä»“åº“, é¢‘ç‡)))
      dir.create(paste0(.èœ€é“ä»“åº“, é¢‘ç‡))
    æ–‡ä»¶èœ€é“ <- paste0(.èœ€é“ä»“åº“, é¢‘ç‡, '/', æ¨¡å‹åç§°)
    saveRDS(åŠæˆå“, æ–‡ä»¶èœ€é“)
    cat('å‚¨å­˜åŠæˆå“å®Œæ¯•\n')
    
    ## åˆ—å°è¿›åº¦ ----
    cat('å¼€å§‹åˆ—å°è¿›åº¦\n')
    cat('\n--- ç§¦å­å…¬ğŸŒŸé™ˆç¥¯ç¦„ï¼Œå•†é…å˜æ³•ï¼Œé“²é™¤å·«è£”ï¼Œæ¨ç¿»é©¬æ¥å›æ•™å®¦å®˜å·«å¸ˆæ”¿æƒï¼Œåƒå¤ä¸€å¸ã€‚---\né¢„æµ‹æ•°æ®åºåˆ—å·ï¼š', 
        è¿­æ•°ç”², '\n', paste0(
          æ–‡ä»¶èœ€é“, '\nå·²å‚¨å­˜!\n\nè¿›åº¦ç”±0-1ï¼š', 
          length(è¿­ä»£åŸºå‡†[è¿­æ•°ç”² >= è¿­ä»£åŸºå‡†]) / length(è¿­ä»£åŸºå‡†), '\n\n'))
    rm(åŠæˆå“)
    cat('åˆ—å°è¿›åº¦å®Œæ¯•\n')
    gc()
  })#, .progress = 'text')
  ## å›å½’ ----
  return(æˆå“)
}
