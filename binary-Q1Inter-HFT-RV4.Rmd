---
title: "<img src='文艺坊图库/deriv.png' height='240'>"
subtitle: "[<span style='color:#DE5D83; background-color:black;'>Deriv.com</span> - 筛选日内高频量化交易统计模型 <span style='color:#4E79A7'>**校阅（第IV部）**</span>](https://github.com/englianhu/binary.com-interview-question)"
author: "[®γσ, ξηg Lιαη Ημ（雷欧）](https://englianhu.github.io) <img src='文艺坊图库/quantitative trader 1.png' height='14'> <img src='文艺坊图库/ENG.png' height='14'>® <img src='文艺坊图库/021 - 04.jpg' height='14'> <img src='文艺坊图库/Peking University 02.png' height='14'>" 
date: "`r lubridate::today('Asia/Shanghai')`"
output:
  html_document: 
    mathjax: https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js
    number_sections: yes
    toc: yes
    toc_depth: 6
    toc_float:
      collapsed: yes
      smooth_scroll: yes
    code_folding: hide
    css: CSSBackgrounds.css
---

# 主题

<br>
<span style='color:green'>**🐊 主题曲 🐊**</span>
<br>

<audio controls loop autoplay src="文艺坊曲库/Mika - Elle me dit (happy song to be millionaire).mp3" controls></audio>
<br>

> 我们的政策是让一部分人、一部分地区先富起来，以带动和帮助落后的地区，先进地区帮助落后地区是一个义务。
>
> ————邓小平1986年3月28日在会见新西兰总理朗伊时说

引用：[邓小平：让一部分人先富起来](http://cpc.people.com.cn/GB/34136/2569304.html)

> [《万般皆下品，唯有读书高》]{style="color:#3C33FF"}<br>
[习李经济，一带一路；]{style="color:#6883FC"}<br>
[九二共识，量化对冲。]{style="color:#6883FC"}<br>
[鞭策六四，铲除黑帮；]{style="color:#6883FC"}^[尤其是咱们东南亚屠杀630万人类的巫师Judi邪教宦官巫裔博彩庄诸国]<br>
[推广量化，提倡学术。]{style="color:#6883FC"}<br>
[百家争鸣，振兴中华；]{style="color:#6883FC"}<br>
[学海无涯，唯勤是岸。]{style="color:#6883FC"}

> 《量化短歌行》<br>
[**高频量化**，人生几何？]{style="color:#6883FC"}，<br>
譬如朝露，去日苦多。<br>
慨当以慷，忧思难忘；<br>
[何以解忧，唯有**陆羽（三战）**]{style="color:#6883FC"}。<br>
青青子衿，悠悠我心；<br>
但为君故，沉吟至今。<br>
呦呦鹿鸣，食野之苹；<br>
[我有**鸿门**，鼓瑟吹笙。]{style="color:#6883FC"}<br>
[明明如**日**，何时可掇?]{style="color:#6883FC"}<br>
忧从中来，不可断绝。<br>
越陌度阡，枉用相存；<br>
契阔谈宴，心念旧恩。<br>
月明星稀，乌鹊南飞；<br>
绕树三匝，何枝可依？<br>
[**春秋战国，卐家争鸣（🇩🇪德意志崇祯）**；]{style="color:#6883FC"}<br>
[**北京鸟巢，卐鸟归巢（🇩🇪德意志崇祯）**。]{style="color:#6883FC"}<br>
[**辛亥革命，根除巫裔**；]{style="color:#6883FC"}<br>
[**终止疫情，拯救全球**。]{style="color:#6883FC"}<br>
山不厌高，海不厌深；<br>
周公吐哺，天下归心。

<img src='文艺坊图库/css.jpeg' height='100'>

家翁ξηg Tεηg

<img src='文艺坊图库/鞭策六四，推广量化；百家争鸣，振兴中华。.png' height='200'>

世间再无祖父黄实田，外祖母郑邓

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:#787878'>Elle me dit</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:#787878'>她对我说</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:#787878'>She told me</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:#787878'>彼女は私に言う</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:#787878'>écris une chanson contente</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:#787878'>写一首欢快的歌</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:#787878'>Write a happy song</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:#787878'>幸せな歌を書く</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:#787878'>Pas une chanson déprimante</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:#787878'>而不是悲伤的歌</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:#787878'>Not a depressing song</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:#787878'>気のめいるような歌ではない</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:#787878'>Une chanson que tout le monde aime</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:#787878'>一首让所有人都喜欢的歌</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:#787878'>A song that everyone loves</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:#787878'>みんなが大好きな曲</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:#787878'>Elle me dit</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:#787878'>她对我说</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:#787878'>She told me</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:#787878'>彼女は私に言う</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:#787878'>Tu deviendras milliardaire</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:#787878'>你将成为亿万富翁</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:#787878'>You will become a millionaire</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:#787878'>あなたは億万長者になります</span>

------

<span style='color:blue'>**F**</span><span style='color:white'>**R**</span><span style='color:red'>**A**</span> : <span style='color:#787878'>Tu auras de quoi être fier</span>

<span style='color:red'>**C**</span><span style='color:yellow'>**H**</span><span style='color:red'>**N**</span> : <span style='color:#787878'>你将为此感到骄傲</span>

<span style='color:blue'>**E**</span><span style='color:red'>**N**</span><span style='color:blue'>**G**</span> : <span style='color:#787878'>You will be proud</span>

<span style='color:white'>**J**</span><span style='color:red'>**P**</span><span style='color:white'>**N**</span> : <span style='color:#787878'>あなたは誇りに思うでしょう</span>

<br>

# 设定

## SCSS 设置

<style>
pre {
  overflow-x: auto;
}
pre code {
  word-wrap: normal;
  white-space: pre;
}
.table-hover > tbody > tr:hover { 
  background-color: #8D918D;
}
</style>

```{r 读取SASS, class.source='bg-success', class.output='bg-primary'}
# install.packages('remotes', dependencies = TRUE, INSTALL_opts = '--no-lock')
library('BBmisc', 'rmsfuns')
#remotes::install_github("rstudio/sass")
lib('sass')

## https://support.rstudio.com/hc/en-us/articles/200532197
## https://community.rstudio.com/t/r-does-not-display-korean-chinese/30889/3?u=englianhu
#Sys.setlocale("LC_CTYPE", "en_US.UTF-8")
#Sys.setlocale("LC_CTYPE", "zh_CN.UTF-8")
#Sys.setlocale(category = "LC_CTYPE", "Chinese (Simplified)_China.936")
#Sys.setlocale(locale = "Chinese")
#Sys.setlocale(locale = "Japanese")
#Sys.setlocale(locale = "English")

# rmarkdown::render('/home/englianhu/Documents/owner/ryo-cn.Rmd',  encoding = 'UTF-8')
#Sys.setlocale("LC_CTYPE", "UTF-8")
#Sys.setlocale(locale = "UTF-8")
#Sys.setlocale(category = "LC_ALL", locale = "chs")
#Sys.setlocale(category = "LC_ALL", locale = "UTF-8")
#Sys.setlocale(category = "LC_ALL", locale = "Chinese")
#Sys.setlocale(category = "LC_ALL", locale = "zh_CN.UTF-8")
Sys.setlocale("LC_ALL", "en_US.UTF-8")
```

```{scss SCSS设置, class.source='bg-success', class.output='bg-primary'}
/* https://stackoverflow.com/a/66029010/3806250 */
h1 { color: #002C54; }
h2 { color: #2F496E; }
h3 { color: #375E97; }
h4 { color: #556DAC; }
h5 { color: #92AAC7; }

/* ----------------------------------------------------------------- */
/* https://gist.github.com/himynameisdave/c7a7ed14500d29e58149#file-broken-gradient-animation-less */
.hover01 {
  /* color: #FFD64D; */
  background: linear-gradient(155deg, #EDAE01 0%, #FFEB94 100%);
  transition: all 0.45s;
  &:hover{
    background: linear-gradient(155deg, #EDAE01 20%, #FFEB94 80%);
    }
  }

.hover02 {
  color: #FFD64D;
  background: linear-gradient(155deg, #002C54 0%, #4CB5F5 100%);
  transition: all 0.45s;
  &:hover{
    background: linear-gradient(155deg, #002C54 20%, #4CB5F5 80%);
    }
  }

.hover03 {
  color: #FFD64D;
  background: linear-gradient(155deg, #A10115 0%, #FF3C5C 100%);
  transition: all 0.45s;
  &:hover{
    background: linear-gradient(155deg, #A10115 20%, #FF3C5C 80%);
    }
  }
```

```{r 编织选项, class.source='hover01', class.output='hover02'}
## 更换时间区域，保留日期时间。
Sys.setenv(TZ = 'Asia/Tapei')

## 忽略所有警讯
## https://stackoverflow.com/a/36846793/3806250
## 设置宽度
## options(knitr.table.format = 'html')将所有kableExtra图表一致设置为'html'格式，省略设置各别图表。
## options(repos = 'https://cran.rstudio.com')将仓库设置为安全网。
## options(repos = 'http://cran.rstudio.com')将仓库设置为普通网。
options(warn = -1, width = 999, knitr.table.format = 'html', 
        digits = 16, digits.secs = Inf, repos = 'https://cran.rstudio.com')

## https://stackoverflow.com/questions/39417003/long-vectors-not-supported-yet-abnor-in-rmd-but-not-in-r-script
## https://yihui.org/knitr/options
knitr::opts_chunk$set(
  class.source = 'hover01', class.output = 'hover02', class.error = 'hover03', 
  message = FALSE, warning = FALSE, error = TRUE, 
  autodep = TRUE, aniopts = 'loop', progress = TRUE, verbose = TRUE, 
  cache = FALSE, cache.lazy = FALSE, result = 'asis')
```

## 设置

读取以下所需程序包。

```{r 读取程序包}
## 读取程序包、设置编织与环境选项。
## 3210448065@qq.com
## leiou123

## 2849108450@qq.com
## leiou123
## https://rstudio.cloud/project/1198888

## 读取'BBmisc'程序包。
if(suppressMessages(!require('BBmisc'))){
  install.packages('BBmisc', dependencies = TRUE, INSTALL_opts = '--no-lock')
  suppressMessages(library('BBmisc'))
}
if (suppressMessages(!require('rmsfuns'))) {
  install.packages('rmsfuns', dependencies = TRUE, INSTALL_opts = '--no-lock')
  suppressMessages(library('rmsfuns'))
}

if(!require('REmap')) devtools::install_github('lchiffon/REmap')

## 一次性读取所需程序包。
library('dplyr', warn.conflicts = FALSE)
library('lubridate', warn.conflicts = FALSE)
library('data.table', warn.conflicts = FALSE)
library('conflicted', warn.conflicts = FALSE)

conflict_prefer('filter', 'dplyr', quiet = TRUE)
conflict_prefer('select', 'dplyr', quiet = TRUE)
conflict_prefer('mutate', 'dplyr', quiet = TRUE)
conflict_prefer('rename', 'dplyr', quiet = TRUE)
conflict_prefer('collapse', 'dplyr', quiet = TRUE)
conflict_prefer('year', 'lubridate', quiet = TRUE)
conflict_prefer('first', 'data.table', quiet = TRUE)
conflict_prefer('last', 'data.table', quiet = TRUE)
conflict_prefer('transpose', 'data.table', quiet = TRUE)

程序包 <- c(
  'devtools', 'knitr', 'kableExtra', 'tint', 'furrr', 'tidyr', 
  'readr', 'lubridate', 'reprex', 'stringr', 'feather', 'purrr', 
  'quantmod', 'tidyquant', 'tibbletime', 'timetk', 'plyr', 'dplyr', 
  'dbplyr', 'magrittr', 'sarima', 'tidyverse', 'memoise', 'htmltools', 
  'formattable', 'dtplyr', 'zoo', 'forecast', 'seasonal', 'magittr', 
  'seasonalview', 'rjson', 'rugarch', 'rmgarch', 'mfGARCH', 
  'sparklyr', 'jcolors', 'TSA', 'microbenchmark', 'dendextend', 
  'lhmetools', 'gtools', 'stringi', 'pacman', 'profmem', 'ggthemes', 
  'flyingfox', 'htmltools', 'echarts4r', 'viridis', 'hrbrthemes', 
  'fable', 'fabletools', 'Rfast', 'Metrics', 'MLmetrics')

# load_pkg(程序包)
suppressAll(lib(程序包))
load_pkg(程序包)
rm(程序包)

.路径 <- getwd() |> 
    {\(.) str_split(., '/')}() |> 
    {\(.) c('/', .[[1]][2:5])}() |> 
    {\(.) c(., 'binary.com-interview-question-data/')}() |> 
    {\(.) paste(., collapse = '/')}() |> 
    {\(.) substring(., 2)}()

## 设置googleVis选项，促使plot.gvis只陈列HTML格式的完成品。
谷歌绘图设置 <- options(gvis.plot.tag = 'chart')

## <audio src='文艺坊曲库/bigmoney.mp3' autoplay controls loop></audio>
```

```{r 设置函数优先权}
conflict_prefer('filter', 'dplyr', quiet = TRUE)
conflict_prefer('select', 'dplyr', quiet = TRUE)
conflict_prefer('mutate', 'dplyr', quiet = TRUE)
conflict_prefer('rename', 'dplyr', quiet = TRUE)
conflict_prefer('collapse', 'dplyr', quiet = TRUE)
conflict_prefer('year', 'lubridate', quiet = TRUE)
conflict_prefer('permutations', 'gtools', quiet = TRUE)
```

<br>

# 简介

[<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:red'>*Blooper*</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT)科研论文中提及一些技术问题，故此使用**Part I**中的数据加以修饰并回测，再与**Part II**比较，筛选最优统计模型。

- [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part I)*</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT-RV1) (发布于RPubs.com)
- [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part I)*</span>](https://beta.rstudioconnect.com/content/16240/binary-Q1Inter-HFT-RV1.html) (发布于RStudioConnect.com)
- [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part II)*</span>](https://rpubs.com/englianhu/742275) (发布于RPubs.com)
- [<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part II)*</span>](https://beta.rstudioconnect.com/content/8a7cbdce-6fc5-409b-8072-9ff21dbd32eb) (发布于RStudioConnect.com)

在此论文中，使用[季节性自回归综合滑均模型系列]{style="color:RoyalBlue"}。

- 季节性指数平滑模型（Seasonal Exponential Smoothing - Seasonal ETS）
- 外部因素周期性自回归综合滑均模型（ARIMAX）
- 季节性自回归综合滑均模型（SARIMA）
- 外部因素周期性季节性自回归综合滑均模型（SARIMAX）
- 外部因素周期性自回归分整综合滑均模型（Auto Regressive Fractionally Integrated Moving Average Exogenous - ARFIMAX）
- 多元季节性自回归综合滑均模型（Multi-Seasonal Time Series `msts()`）

> #自动化 #科研科学 #尚未试驾 尚未试驾🚗

引用：[抖音 - 电动车](https://v.douyin.com/YxVy48K)

<iframe width="560" height="315" src="https://www.youtube.com/embed/0OvkWGRhf_g" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

引用：[Tumblr - Bayesian Hidden Markov Models for Time Series](https://www.tumblr.com/blog/view/englianhu/641578918656212992?source=share)

> 辛亥革命，铲除巫裔；<br>
终止屠杀，拯救全球。

**咱们东南亚屠杀630万人类的巫师Judi邪教宦官巫裔博彩庄诸国**

小时候都在日本动漫文化的环境下长大。小学时期在明智华校上学就已经学会万事具备，都会提前30分钟抵达做好准备才不会仓促。自从2002年学习日语后，由于平时从旺沙马朱宿舍到拉曼学院徒步上学需要时间提前准备，所以都会将时间设为提前20分钟，基于从旺沙马朱宿舍徒步耗时45分钟左右，索性设为提前一个小时，所以愚生将所有电子仪器的标准时间都一律设为日本标准时间，然后青梅竹马的郑添和同学问过我，我回答：“我的时间必须比别人快，我的世界必须比别人快，才能占有先机～”，所以设置提前一个小时日本标准时间，再提前一小时就看到是本土提前两个小时。**自从2019年在菲律宾阿里与中国同胞工作离职后，就开始思考身为🇹🇼🇨🇳中华民族，岂能沦为（大化革新的）倭奴或者倭寇，所以目前的科研语言、时间标准、甚至编码，都一律使用汉字。**由于数据上的交易时间出现时差的缘故，在读取数据后就将数据上的时间更换，添加一小时时差为中国标准时间，以确保时间规律计算方面，不会出错。

<span style='color:green'>**进程进度函数**</span>

```{r 进程布告栏}
运算进度表 <- function(导入数据, 起点 = NULL, 秒计 = 60, .匹配元素 = '^季节性自回归_', .周期性 = TRUE) {
  ## ------------- 定时查询进度 ----------------------
  ## 每分钟自动查询与更新以上模拟预测汇价进度（储存文件量）。
  require('magrittr')
  require('tibble')
  
  if(!is.data.frame(class(导入数据))) { 
	导入数据 %<>% data.frame
  }
  
  if (.周期性 == TRUE) {
    while(1) {
      cat('当前中国标准时间：', as.character(now('Asia/Shanghai')), '\n\n')
      
      日子 = as_date(导入数据$年月日时分) %>% 
			unique
      #过滤并忽略每周闭市价时间 --- 周六凌晨12点，然后每周闭市价时间点为周五11:59PM。
      日子 <- 日子[weekdays(日子) != 'Saturday']
      
	    动态日 = 日子
	    
	    if(is.null(起点)) { 
		    起点 = 日子[1]
	    } else if (is.Date(起点)) { 
		    起点 = as_date(起点)
	    } else {
		    起点 = as_date(导入数据$年月日时分) %>% 
		    unique
	    }
  	  
	    日子 = 日子[日子 >= 起点]
      
      布告栏 = list.files(
        paste0(.路径, '文艺数据库/fx/USDJPY/'), pattern = .匹配元素) %>% 
	      str_replace_all('.rds', '') %>% 
		  str_replace_all('.201', '_201') %>% 
		  str_split_fixed('_', '2') %>% 
		  as_tibble %>% 
		  rename('统计模型' = 'V1', '日期' = 'V2') %>% 
		  mutate(统计模型 = factor(统计模型), 日期 = as_date(日期))
		
	  布告栏 = join(tibble(日期 = 动态日), 布告栏) %>% 
		  as_tibble	  
	  布告栏 %<>% na.omit
	  
      布告栏 %<>% mutate(有否 = if_else(is.na(统计模型), 0, 1)) %>% 
		  spread(统计模型, 有否)
      
      布告栏进度表 <- ldply(布告栏[,-1], function(布告栏参数) {
		  na.omit(布告栏参数) %>% length }) %>% 
		  rename(进度 = V1) %>% 
		  mutate(完成 = length(日子), 进度 = percent(进度/完成))
      
      print(布告栏进度表)
      
      进度表 = sum(布告栏进度表$进度)/sum(布告栏进度表$完成)
      cat('\n================', as.character(percent(进度表)), '================\n\n')
      
      if (进度表 == 1) break #倘若进度达到100%就停止更新。
      
      Sys.sleep(秒计) #以上ldply()耗时3~5秒，而休息时间60秒。
    }
  } else {
    
    cat('当前中国标准时间：', as.character(now('Asia/Shanghai')), '\n\n')
      
      日子 = as_date(导入数据$年月日时分) %>% 
			unique
	  动态日 = 日子
		
	  if(is.null(起点)) { 
		  起点 = 日子[1]
	  } else if (is.Date(起点)) { 
		  起点 = as_date(起点)
	  } else {
		  起点 = as_date(导入数据$年月日时分) %>% 
		  unique
	  }
	
	  日子 = 日子[日子 >= 起点]
    
      布告栏 = list.files(paste0(.路径, '文艺数据库/fx/USDJPY/'), pattern = .匹配元素) %>% 
	      str_replace_all('.rds', '') %>% 
		  str_replace_all('.201', '_201') %>% 
		  str_split_fixed('_', '2') %>% 
		  as_tibble %>% 
		  rename('统计模型' = 'V1', '日期' = 'V2') %>% 
		  mutate(统计模型 = factor(统计模型), 日期 = as_date(日期))
		
	  布告栏 = join(tibble(日期 = 动态日), 布告栏) %>% 
		  as_tibble
	  布告栏 %<>% na.omit
	  
      布告栏 %<>% mutate(有否 = if_else(is.na(统计模型), 0, 1)) %>% 
		  spread(统计模型, 有否)
        
      布告栏进度表 <- ldply(布告栏[,-1], function(布告栏参数) {
		  na.omit(布告栏参数) %>% length }) %>% 
		  rename(进度 = V1) %>% 
		  mutate(完成 = length(日子), 进度 = percent(进度/完成))
                
    print(布告栏进度表)
    
    进度表 = sum(布告栏进度表$进度)/sum(布告栏进度表$完成)
    cat('\n================', as.character(percent(进度表)), '================\n\n')
    }
  }
```

<br>

# 数据

## 读取数据

**Part I**中使用的原始数据已加以修饰并储存，**Part II**与**Part III**次论文读取该数据，将网页轻巧化、省略掉修饰数据的一栏。

```{r 绘制样本数据图表, results = 'asis'}
## 检验是否已设置路径。
if(!exists('.路径')) {
  .路径 <- getwd() |> 
    {\(.) str_split(., '/')}() |> 
    {\(.) c('/', .[[1]][2:5])}() |> 
    {\(.) c(., 'binary.com-interview-question-data/')}() |> 
    {\(.) paste(., collapse = '/')}() |> 
    {\(.) substring(., 2)}()
  }

## 倘若环境尚未有数据，读取文件数据。
if(!exists('样本1')) {
  样本1 <- readRDS(paste0(.路径, '文艺数据库/fx/USDJPY/样本1.rds'))}

## 绘制样本图表
样本1[c(1:3, (nrow(样本1)-3):nrow(样本1)),] |> 
    {\(.) kbl(., caption = '每分钟价位', escape = FALSE)}() |> 
  ## https://www.w3schools.com/cssref/css_colors.asp
  ## https://public.tableau.com/en-us/gallery/100-color-palettes?gallery=votd
    {\(.) row_spec(., 
      0, background = 'DimGrey', color = 'gold', bold = TRUE)}() |> 
    {\(.) column_spec(., 1, background = 'CornflowerBlue')}() |> 
    {\(.) column_spec(., 2, background = 'Gray')}() |> 
    {\(.) column_spec(., 3, background = 'DarkGrey')}() |> 
    {\(.) column_spec(., 4, background = 'Gray')}() |> 
    {\(.) column_spec(., 5, background = 'DarkGrey')}() |> 
    {\(.) column_spec(., 6, background = '#4897D8')}() |> 
    {\(.) column_spec(., 7, background = '#556DAC')}() |> 
    {\(.) column_spec(., 8, background = '#92AAC7')}() |> 
    {\(.) column_spec(., 9, background = '#556DAC')}() |> 
    {\(.) column_spec(., 10, background = '#375E97')}() |> 
    {\(.) column_spec(., 11, background = 'CornflowerBlue')}() |> 
    {\(.) column_spec(., 
      12, background = 'LightGray', color = 'goldenrod')}() |> 
    {\(.) kable_styling(., 
      bootstrap_options = c(
        'striped', 'hover', 'condensed', 'responsive'))}() |> 
  ##`full_width = FALSE`是将每列设置为伸缩性自动调整宽度。
    {\(.) kable_material(., full_width = FALSE)}() |> 
    {\(.) scroll_box(., width = '100%', fixed_thead = TRUE, height = '400px')}()
```

*数据 : `r paste0(dim(样本1)[1], '行 x ', dim(样本1)[2], '列')`*

以上图表显示数据日期，由`r paste(range(样本1$日期), collapse = ' 至 ')`，而该数据也是在论文*(Part I)*、*(Part II)*中使用，并且相符。使用同样的数据，是为了在回测多元统计模型，才能获知并筛选最优统计模型。

# 统计建模

在此先过滤数据，从2016年的第一个预测日（`r filter(样本1, 年份 == 2016)$日期[1]`开始，也就是读取的样本数据中的第二年数据开始），与论文*(Part I)*、*(Part II)*中相符。

## 季节性指数平滑模型（Seasonal ETS））`ts()` & `ets()`

#### 20小时一周期（1200分钟循环1次）

## 自回归综合滑均模型系列（ARIMA Series）

### 季节性数据建模

> ARIMA(p,d,q)模型中
>
- p是自回归(AR)的项数，用来获取自变量
- d是差分(I)的系数，为了使时间序列平稳
- q是移动平均(MA)的项数，为了使其光滑

引用：[ARIMA模型中的三个参数(p, d, q)都是什么意思?](http://sofasofa.io/forum_main_post.php?postid=1000324)

> 运用SPSS 19.0软件中的相关模块进行数据处理和分析。本研究是以月份为时间单位的研究序列，故选择复合季节模型[5, 6]：ARIMA(p，d，q)(P，D，Q)s，参数p为非季节性自回归阶数，d为一般差分阶数，q为非季节性滑动平均阶数；P为季节性自回归阶数，D为季节差分阶数，Q为季节性移动平均阶数，s为季节模型的时间单位相应周期(本研究s=12)。

引用：[北京市昌平区肺结核发病数ARIMA模型预测](http://www.jbjc.org/JBJC/html/article_8538.htm)

[<span style='color:#DE5D83; background-color:black;'>*Deriv.com*</span> - *Interday High Frequency Trading Models Comparison* <span style='color:RoyalBlue'>*Review (Part II)*</span>](https://rpubs.com/englianhu/742275)中，结论1200分钟为最优数据量，故此我将数据量设置为(1200分钟，也就是等于20个交易小时)，去预测下一分钟交易价格。然而如何灵活设置周期量与周期数、运用循环周期呢？在此尝试回测方能得以证实。

- [<span style='color:white; background-color:LightSlateGrey;'>*8.7 ARIMA modelling in R*</span> in **Forecasting: Principles and Practice (2nd Edition)**](https://otexts.com/fpp2/arima-r.html)
- [<span style='color:white; background-color:LightSlateGrey;'>*8.9 Seasonal ARIMA models*</span> in **Forecasting: Principles and Practice (2nd Edition)**](https://otexts.com/fpp2/seasonal-arima.html)
- [Seasonality in `auto.arima()` from `forecast` package](https://stackoverflow.com/a/37400899/3806250)

```{r, eval=FALSE}
source('函数/季节性自回归.R')

时间索引 <- unique(样本1$日期)
# 基准 <- filter(样本1, 年份 == 2016)$日期[1] #"2016-01-04" 第2年第1个交易日
基准 <- 样本1[年份 == 2016]$日期[1]
时间索引 %<>% .[. >= 基准]
时间索引 %<>% .[1:6] #筛选数据中的前6个日期为样本
# 时间索引 %<>% .[. >= as_date('2016-01-04')]
数据量 <- 1200 #筛选数据中的最后1200观测值：样本1[(.N - (数据量 - 1)):.N]
预测时间单位 <- 1

.模型选项 = c('自动化', '自回归滑均')
# .模型选项 %<>% .[1]
# .模型选项 %<>% .[2]
.差分阶数 = 0:2
.季节性差分阶数 = 0:1 
季节性与否 = c(TRUE, FALSE)
## https://stackoverflow.com/questions/37400062/seasonality-in-auto-arima-from-forecast-package
#近似值与否 <- c(TRUE, FALSE)
#逐步精化与否 <- c(TRUE, FALSE)

## .时序规律 <- c(0, 0, 0)
.时序规律 <- permutations(6, 3, 0:5, repeats.allowed = TRUE) %>% 
  as.data.table
.时序规律 <- setnames(.时序规律, old = c('V1', 'V2', 'V3'), new = c('自回归阶数', '差分阶数', '滑均阶数'))[差分阶数 <= 2]

## .季节性规律参数 <- c(0, 0, 0)
.季节性规律参数 <- permutations(6, 3, 0:5, repeats.allowed = TRUE) %>% 
  as.data.table
.季节性规律参数 <- setnames(.季节性规律参数, old = c('V1', 'V2', 'V3'), new = c('季节性自回归阶数', '季节性差分阶数', '季节性滑均阶数'))[季节性差分阶数 <= 2]
```

#### 20小时一周期（1200分钟循环1次）

```{r, eval=FALSE}
循环周期 = 1200

## 由于forecast::Arima()出现多种错误信息，故此忽略使用该函数建模。
## https://github.com/englianhu/binary.com-interview-question/issues/6
llply(.模型选项[1], function(模型) {
  
  if(模型 == '自动化') {
    季回归0 <- llply(.差分阶数, function(差分阶数) {
      季回归1 <- llply(.季节性差分阶数, function(季节性差分阶数) {
        季回归2 <- llply(季节性与否, function(季节) {
          季回归3 <- llply(时间索引, function(时序) {
            成效 <- 季节性自回归(
              时间索引 = 时序, 样本 = 样本1, 路径 = .路径, 
              数据量 = 数据量, 循环周期 = 循环周期, 
              预测时间单位 = 预测时间单位, .模型选项 = 模型, 
              .差分阶数 = 差分阶数, .季节性差分阶数 = 季节性差分阶数, 
              季节性与否 = 季节, 静态与否 = FALSE, 记载自回归与否 = FALSE, 
              信息量准则 = c('aicc', 'aic', 'bic'), 逐步精化与否 = TRUE, 
              逐步精化量 = 94, #近似值与否=(length(x)>150|frequency(x)>12), 
              缩写 = NULL, 计策谋略 = NULL, #x = y, 
              趋势 = NULL, 测试 = c('kpss', 'adf', 'pp'), 测试参数 = list(), 
              季节性测试参数 = list(), 
              季节性测试 = c('seas', 'ocsb', 'hegy', 'ch'), 
              允许截距与否 = TRUE, 允许包含均值与否 = TRUE, 
              博克斯考克斯变换 = NULL, 
              偏差调整与否 = FALSE, 多管齐下与否 = FALSE, 核心量 = 2)
            })
          })
        })
      })
    
  } else if (模型 == 'Arima') {
    季回归0 <- llply(1:nrow(.时序规律), function(迭数1) {
      季回归1 <- llply(1:nrow(.季节性规律参数), function(迭数2) {
        季回归2 <- llply(时间索引, function(时序) {
          成效 <- 季节性自回归(时间索引 = 时序, 样本 = 样本, 路径 = .路径, 
            数据量 = 数据量, 预测时间单位 = 预测时间单位, 
            .模型选项 = 模型, .时序规律 = unlist(.时序规律[迭数1,]), 
            .季节性规律参数 = unlist(.季节性规律参数[迭数2,]), 趋势 = NULL, 
            允许包含均值与否 = TRUE, 允许截距与否 = FALSE, 
            包含均值与否 = TRUE, 包含截距 = TRUE, 
            #包含常数与否 = 包含常数与否, 
            #统计模型 = NULL, 博克斯考克斯变换 = 博克斯考克斯变换, x = y, 
            偏差调整与否 = FALSE, 计策谋略 = c('CSS-ML', 'ML', 'CSS'))
        })
      })
    })
    
  } else {
    
  }
  return(srm)
})
```

#### 10小时一周期（600分钟循环2次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 6.67小时一周期（400分钟循环3次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 5小时一周期（300分钟循环4次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 4小时一周期（240分钟循环5次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 3.33小时一周期（200分钟循环6次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 2.5小时一周期（150分钟循环8次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 2小时一周期（120分钟循环10次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 1.67小时一周期（100分钟循环12次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 1.33小时一周期（80分钟循环15次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 1小时一周期（60分钟循环20次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.83小时一周期（50分钟循环24次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.67小时一周期（40分钟循环30次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 半小时一周期（30分钟循环40次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.40小时一周期（24分钟循环50次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.33小时一周期（20分钟循环60次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.27小时一周期（16分钟循环75次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.25小时一周期（15分钟循环80次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.20小时一周期（12分钟循环100次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.17小时一周期（10分钟循环120次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.13小时一周期（8分钟循环150次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.10小时一周期（6分钟循环200次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.08小时一周期（5分钟循环240次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.07小时一周期（4分钟循环300次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.05小时一周期（3分钟循环400次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.03小时一周期（2分钟循环600次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

#### 0.02小时一周期（1分钟循环1200次）

```{r, eval=FALSE}
培训数据$闭市价 %>% 
    matrix(dimnames = list(培训数据$年月日时分, '闭市价')) %>% 
    tk_ts(frequency = 60)
```

### 自回归综合滑均模型（ARIMA）`ts()` & `auto.arima()`

### 外部因素周期性自回归综合滑均模型（ARIMAX）`ts()` & `auto.arima()`

- [arima xreg argument error caused by column name in data frame](https://stackoverflow.com/a/55229110/3806250)

### 季节性自回归综合滑均模型（SARIMA）`ts()` & `auto.arima()`

### 外部因素周期性季节性自回归综合滑均模型（SARIMAX）`ts()` & `auto.arima()`

- [SARIMAX model in R](https://stackoverflow.com/questions/17816868/sarimax-model-in-r)

```{r, eval=FALSE}
时间索引 <- unique(样本$日期)
# 基准 <- filter(样本, 年份 == 2016)$日期[1] #"2016-01-04" 第2年第1个交易日
基准 <- 样本[年份 == 2016]$日期[1]
时间索引 %<>% .[. >= 基准]
时间索引 %<>% .[1:6] #筛选数据中的前6个日期为样本
# 时间索引 %<>% .[. >= as_date('2016-01-04')]
数据量 <- 1200 #筛选数据中的最后1200观测值：样本[(.N - (数据量 - 1)):.N]
预测时间单位 <- 1

.模型选项 = c('自动化', '自回归滑均')
# .模型选项 %<>% .[1]
# .模型选项 %<>% .[2]
.差分阶数 = 0:2
.季节性差分阶数 = 0:1 
季节性与否 = c(TRUE, FALSE)
## https://stackoverflow.com/questions/37400062/seasonality-in-auto-arima-from-forecast-package
#近似值与否 <- c(TRUE, FALSE)
#逐步精化与否 <- c(TRUE, FALSE)

## .时序规律 <- c(0, 0, 0)
.时序规律 <- permutations(6, 3, 0:5, repeats.allowed = TRUE) %>% 
  as.data.table
.时序规律 <- setnames(.时序规律, old = c('V1', 'V2', 'V3'), new = c('自回归阶数', '差分阶数', '滑均阶数'))[差分阶数 <= 2]

## .季节性规律参数 <- c(0, 0, 0)
.季节性规律参数 <- permutations(6, 3, 0:5, repeats.allowed = TRUE) %>% 
  as.data.table
.季节性规律参数 <- setnames(.季节性规律参数, old = c('V1', 'V2', 'V3'), new = c('季节性自回归阶数', '季节性差分阶数', '季节性滑均阶数'))[季节性差分阶数 <= 2]
```

```{r eval=FALSE}
# --------- eval=FALSE ---------
llply(.模型选项, function(模型) {
  
  if(模型 == '自动化') {
    季回归0 <- llply(.差分阶数, function(差分阶数) {
      季回归1 <- llply(.季节性差分阶数, function(季节性差分阶数) {
        季回归2 <- llply(季节性与否, function(季节) {
          季回归3 <- llply(时间索引, function(时序) {
            成效 <- 季节性自回归(时间索引 = 时序, 样本 = 样本, 路径 = .路径, 
              数据量 = 数据量, 预测时间单位 = 预测时间单位, .模型选项 = 模型, 
              .差分阶数 = 差分阶数, .季节性差分阶数 = 季节性差分阶数, 
              季节性与否 = 季节, 静态与否 = FALSE, 记载自回归与否 = FALSE, 
              信息量准则 = c('aicc', 'aic', 'bic'), 
              逐步精化与否 = TRUE, 逐步精化量 = 94, 
              #近似值与否=(length(x)>150|frequency(x)>12), 
              缩写 = NULL, 计策谋略 = NULL, #x = y, 
              趋势 = NULL, 测试 = c('kpss', 'adf', 'pp'), 
              测试参数 = list(), 季节性测试参数 = list(), 
              季节性测试 = c('seas', 'ocsb', 'hegy', 'ch'), 
              允许截距与否 = TRUE, 允许包含均值与否 = TRUE, 博克斯考克斯变换 = NULL, 
              偏差调整与否 = FALSE, 多管齐下与否 = FALSE, 核心量 = 2)
            })
          })
        })
      })
    
  } else if (模型 == 'Arima') {
    季回归0 <- llply(1:nrow(.时序规律), function(迭数1) {
      季回归1 <- llply(1:nrow(.季节性规律参数), function(迭数2) {
        季回归2 <- llply(时间索引, function(时序) {
          成效 <- 季节性自回归(时间索引 = 时序, 样本 = 样本, 路径 = .路径, 
            数据量 = 数据量, 预测时间单位 = 预测时间单位, 
            .模型选项 = 模型, .时序规律 = unlist(.时序规律[迭数1,]), 
            .季节性规律参数 = unlist(.季节性规律参数[迭数2,]), 趋势 = NULL, 
            允许包含均值与否 = TRUE, 允许截距与否 = FALSE, 
            #包含常数与否 = 包含常数与否, 
            #统计模型 = NULL, 博克斯考克斯变换 = 博克斯考克斯变换, x = y, 
            偏差调整与否 = FALSE, 计策谋略 = c('CSS-ML', 'ML', 'CSS'))
        })
      })
    })
    
  } else {
    
  }
  return(srm)
})
```

## 季节性自回归综合滑均模型（SARIMA）`msts()` & `auto.arima()`

- [Multiple and long seasonality for a SARIMA model in R](https://stats.stackexchange.com/questions/109835/multiple-and-long-seasonality-for-a-sarima-model-in-r)
- [SARIMAX model in R](https://stackoverflow.com/a/17816958/3806250)

## 季节性自回归综合滑均模型（SARIMA）`fable` & `fabletools`

https://otexts.com/fpp3/seasonal-arima.html

## 自回归综合滑均模型（ARFIMA / ARFIMAX） `arfima()`

### 外部因素周期性自回归综合滑均模型（Auto Regressive Fractionally Integrated Moving Average Exogenous - ARFIMAX）

- [binary.com 面试试题 I - GARCH模型中的`ARIMA(p,d,q)`参数最优化](https://rpubs.com/englianhu/binary-Q1FiGJRGARCH)
- [binary.com 面试试题 I - GARCH模型中的`ARCH in Mean`](https://rpubs.com/englianhu/binary-Q1-archm)

## `msts()` & `hw()`

> After looking a bit more, I've came across this question where a user wanted to use the hw method to forecast half-hourly electricity demand using the taylor dataset available in the forecast package.

> As Professor Rob Hyndman suggest in the response to the linked question, the double seasonal Holt Winters model method dshw from the forecast package can be used to deal with half-hourly data.

> After removing the yearly seasonality parameter (seasonal.periods = 8760) in the definition of my msts object, I've ran the model and it provided a pretty accurate result.

[How can I apply Seasonal Exponential Smoothing forecasting method to hourly data in R](https://stackoverflow.com/a/62430549/3806250)

## `msts()` & `tbats()`

### Seasonal Data Modeling

I set the length of data as weekly (`7200` minutes which is 5 trading days) to forecast `1440` minutes (`1440` minutes is a trading day).

[*Chapter 7 Multivariate TS Analysis* in **Introduction to Time Series Analysis and Forecasting in R**](https://bookdown.org/singh_pratap_tejendra/intro_time_series_r/multivariate-ts-analysis.html), but I use univariate due to some errors as mentioned in beginning.

I tried to use `weeks(1)`, `months(1)`, `months(3)`, `years(1)` but there is not constant observations, we can refer to [`The seasonal period`](https://otexts.com/fpp3/tsibble-objects.html).

Here I filter up the data as below :

- `5 days * 1440 mins = 7200 mins` = weekly
- `22 days * 1440 mins = 31680 mins` = monthly
- `3 months * 22 days * 1440 mins = 95040 mins` = quarterly
- `52 weeks * 5 days * 1440 mins = 374400 mins` = yearly

### (周 ∈ 分) >> 日

I set the length of data as monthly (`22 days * 1440 mins = 31680 mins` minutes which is 22 trading days), nested seasonal weekly (`5 days * 1440 mins = 7200 mins` minutes which is 5 trading days) and `1440` minutes (`1440` minutes is a trading day) to forecast `1440` minutes (`1440` minutes is a trading day).

- data observation length `22 days * 1440 mins = 31680 mins`
- seasonal `5 days * 1440 mins = 7200 mins`
- sub-seasonal `1440 mins`
- forecast `1440 mins`

```{r eval=FALSE}
# --------- eval=FALSE ---------
时间索引 <- unique(样本$date)
基准 <- 样本[year == 2016]$date[1] #"2016-01-04" #1st trading date in 2nd year
时间索引 %<>% .[. >= 基准]
#时间索引 %<>% .[. >= as_date('2016-01-04')]
数据量 <- 7200 #last 7200  observations 样本[(.N - (数据量 - 1)):.N]
预测时间单位 <- 1440
hrz2 <- 1440

llply(ets.m, function(模型) {
  mstseas(时间索引 = 时间索引, 样本, 
        数据量 = 数据量, 预测时间单位 = 预测时间单位, 
        hrz2 = hrz2, .模型选项 = 模型)
  })
```

### (周 ∈ 季) >> 日

I set the length of data as quarterly (`3 months * 22 days * 1440 mins = 95040 mins` minutes which is 66 trading days), nested seasonal weekly (`5 days * 1440 mins = 7200 mins` minutes which is 5 trading days) and `1440` minutes (`1440` minutes is a trading day) to forecast `1440` minutes (`1440` minutes is a trading day).

- data observation length `3 months * 22 days * 1440 mins = 95040 mins`
- seasonal `5 days * 1440 mins = 7200 mins`
- sub-seasonal `1440 mins`
- forecast `1440 mins`

### (周 ∈ 年) >> 日

I set the length of data as yearly (`52 weeks * 5 days * 1440 mins = 374400 mins` minutes which is 260 trading days), nested seasonal weekly (`5 days * 1440 mins = 7200 mins` minutes which is 5 trading days) and `1440` minutes (`1440` minutes is a trading day) to forecast `1440` minutes (`1440` minutes is a trading day).

- data observation length `52 weeks * 5 days * 1440 mins = 374400 mins`
- seasonal `5 days * 1440 mins = 7200 mins`
- sub-seasonal `1440 mins`
- forecast `1440 mins`

### (分 ∈ 季) >> 日

I set the length of data as quarterly (`3 months * 22 days * 1440 mins = 95040 mins` minutes which is 66 trading days), nested seasonal monthly (`22 days * 1440 mins = 31680 mins` minutes which is 22 trading days) and `1440` minutes (`1440` minutes is a trading day) to forecast `1440` minutes (`1440` minutes is a trading day).

- data observation length `3 months * 22 days * 1440 mins = 95040 mins`
- seasonal `22 days * 1440 mins = 31680 mins`
- sub-seasonal `1440 mins`
- forecast `1440 mins`

<br>

# 模型比较

## Read Models

### Grouped Models

> VAR分析中的一个中心问题是找到滞后的阶数，以产生最佳结果。模型比较通常基于信息标准，例如AIC，BIC或HQ。通常，由于是小样本预测，AIC优于其他标准。但是，BIC和HQ在大型样本中效果很好 

引用：[R语言用向量自回归（VAR）进行经济数据脉冲响应研究分析](http://tecdat.cn/r%e8%af%ad%e8%a8%80%e7%94%a8%e5%90%91%e9%87%8f%e8%87%aa%e5%9b%9e%e5%bd%92%ef%bc%88var%ef%bc%89%e8%bf%9b%e8%a1%8c%e7%bb%8f%e6%b5%8e%e6%95%b0%e6%8d%ae%e8%84%89%e5%86%b2%e5%93%8d%e5%ba%94%e7%a0%94)



Here I read the saved models.

Due to the models only forecast `1440 mins` (but not `7200 mins`) in advance, here I no need to filter the forecast price.

# 结论

## 摘要

## Final Conclude

From final stage models comparison, we know that ******* is the <span style='color:white; background-color:#DE5D83;'>**β**est model</span>.

## Future Studies

Next papers will compare `tbats`, `midas`, `sarimax` etc.

```{r 选项设置, echo = FALSE}
## Set options back to original options
options(warn = 0)
```

<br>

# 附录

## 幕后花絮

## 文书明细

以下乃此文书的文件信息。

- 文集建立日：2021-02-03
- 文集最新更新日：`r today('Asia/Shanghai')`
- `r R.version.string`
- [**rmarkdown**](https://github.com/rstudio/rmarkdown) 程序包版本：`r packageVersion('rmarkdown')`
- 文集版本：0.2.1
- 文集作者：[®γσ, ξηg Lιαη Ημ](https://rpubs.com/englianhu/ryo-cn)
- 猫舍：[源代码](https://github.com/englianhu/binary.com-interview-question)
- 追加附属信息


```{r 信息}
#suppressMessages(require('formattable', quietly = TRUE))
#suppressMessages(require('knitr', quietly = TRUE))
#suppressMessages(require('kableExtra', quietly = TRUE))
#suppressMessages(require('magittr', quietly = TRUE))
#suppressMessages(require('devtools', quietly = TRUE))

系统信息1 <- session_info()$platform |> 
    unlist() |> 
    {\(.) data.frame(row.names = 1:length(.), 
                     Category = names(.), session_info = .)}()

系统信息2 <- data.frame(Sys.info()) |> 
    {\(.) data.frame(Category = row.names(.), Sys.info = .[,1])}()

#remarks, dim(系统信息1), dim(系统信息2)
if (nrow(系统信息1) == 11 && nrow(系统信息2) == 8) {
  系统信息2 <- 系统信息2 |> 
    {\(.) rbind(., data.frame(
    Category = c('rmarkdown', 'rsconnect', '当前时间'), 
    Sys.info = c(as.character(getwd()), 
                 as.character(packageVersion('rsconnect')), 
                 paste(as.character(
                   lubridate::now('Asia/Shanghai')), 'CST 中国标准时间 🗺'))))}()
  
} else if (nrow(系统信息1) == 10 && nrow(系统信息2) == 8) {
  系统信息1 <- rbind(系统信息1, data.frame(Category = '', session_info = ''))
  
  系统信息2 <- 系统信息2 |> 
    {\(.) rbind(., data.frame(
    Category = c('rmarkdown', 'rsconnect', '当前时间'), 
    Sys.info = c(as.character(getwd()), 
                 as.character(packageVersion('rsconnect')), 
                 paste(as.character(
                   lubridate::now('Asia/Shanghai')), 'CST 中国标准时间 🗺'))))}()
}

系统信息 <- cbind(系统信息1, 系统信息2)
names(系统信息) <- c('分类1', '访谈信息1', '分类2', '访谈信息2')
系统信息$分类1 <- c('版本', '操作系统', '系统', '界面', '语言', '核对', 
              '©标准库', '时区', '日期', '®文艺坊版本', 'Pandoc瑞士军刀')
系统信息$分类2 <- c('系统名称', '发布', '版本', '元素节点', '机器', '登录', 
              '用户', '活跃用户', 'rmarkdown (®降价编译)', 
              'rsconnect (®s联通)', '当前时间')
rm(系统信息1, 系统信息2)

系统信息 |> 
  {\(.) 
    kbl(., caption = '附加访谈信息：')}() |> 
  {\(.) 
    kable_styling(
      ., bootstrap_options = c('striped', 'hover', 'condensed', 'responsive'))}() |> 
  {\(.) 
    row_spec(., 0, background = 'DimGrey', color = 'yellow')}() |> 
  {\(.) 
    column_spec(., 1, background = 'CornflowerBlue', color = 'red')}() |> 
  {\(.) 
    column_spec(., 2, background = 'grey', color = 'black')}() |> 
  {\(.) 
    column_spec(., 3, background = 'CornflowerBlue', color = 'blue')}() |> 
  {\(.) 
    column_spec(., 4, background = 'grey', color = 'white')}() |> 
  {\(.) 
    row_spec(., 11, bold = TRUE, color = 'yellow', background = '#D7261E')}()
```

## 参考文献

01. [<span style='color:#DE5D83; background-color:black;'>Deriv.com</span> - Interday High Frequency Trading Models Comparison <span style='color:red'>(Blooper)</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT)
02. [<span style='color:#DE5D83; background-color:black;'>Deriv.com</span> - Interday High Frequency Trading Models Comparison <span style='color:RoyalBlue'>Review (Part I)</span>](https://rpubs.com/englianhu/binary-Q1Inter-HFT-RV1) (发布于RPubs.com)
03. [<span style='color:#DE5D83; background-color:black;'>Deriv.com</span> - Interday High Frequency Trading Models Comparison <span style='color:RoyalBlue'>Review (Part I)</span>](https://beta.rstudioconnect.com/content/16240/binary-Q1Inter-HFT-RV1.html) (发布于RStudioConnect.com)
04. [binary.com 面试试题 I - GARCH模型中的`ARCH in Mean`](https://rpubs.com/englianhu/binary-Q1-archm)
05. [binary.com 面试试题 I - GARCH模型中的`ARIMA(p,d,q)`参数最优化](https://rpubs.com/englianhu/binary-Q1FiGJRGARCH)
06. [Forecasting: Principles and Practice](https://otexts.com/fpp3)
07. [Tableau 100 Color Palettes](https://public.tableau.com/en-us/gallery/100-color-palettes)
08. [PYTHON中的ARIMA模型、SARIMA模型和SARIMAX模型对时间序列预测](http://tecdat.cn/python%e4%b8%ad%e7%9a%84arima%e6%a8%a1%e5%9e%8b%e3%80%81sarima%e6%a8%a1%e5%9e%8b%e5%92%8csarimax%e6%a8%a1%e5%9e%8b%e5%af%b9%e6%97%b6%e9%97%b4%e5%ba%8f%e5%88%97%e9%a2%84%e6%b5%8b)
09. [利用SARIMAX进行销量预测](https://blog.csdn.net/fitzgerald0/article/details/100823231)
10. [时间序列分析模型：ARIMA模型和SARIMAX算法](https://maoli.blog.csdn.net/article/details/113835186)
11. [利用SARIMAX進行銷量預測](https://www.twblogs.net/a/5d7ee484bd9eee5327ffe605)
12. [季節性時間序列分析-SARIMAX模型的python實現](https://www.twblogs.net/a/5d66409dbd9eee541c332577)
13. [SARIMAX:简介](https://runebook.dev/zh-CN/docs/statsmodels/examples/notebooks/generated/statespace_sarimax_stata)
14. [Python数据分析案例-分别使用时间序列ARIMA、SARIMAX模型与Auto ARIMA预测国内汽车月销量_maiyida123的博客-程序员资料](http://www.4k8k.xyz/article/maiyida123/117967762)
15. [预测：方法与实践：11.1 复杂季节性](https://otexts.com/fppcn/complexseasonality.html)
16. [市道轮换下的高频数据参数估计]()
17. [STAT 510 Applied Time Series Analysis : 13.1 Long Memory Models and Fractional Differences](https://online.stat.psu.edu/stat510/lesson/13/13.1)
18. [A Complete Introduction To Time Series Analysis (with R):: Exogenous models](https://medium.com/analytics-vidhya/a-complete-introduction-to-time-series-analysis-with-r-exogenous-models-4f009b770104)
19. [Implementation of Time Series Forecasting Methods (SARIMA, SARIMAX and Prophet)](https://medium.com/@shawanugya12/implementation-of-time-series-forecasting-methods-sarima-sarimax-and-prophet-ff8407b25aaa)
20. [Time Series Forecasting Techniques using R](https://github.com/rajsiddarth/Time_Series_Forecasting)
21. [A Guide to Time Series Forecasting in R You Should Know](https://www.simplilearn.com/tutorials/data-science-tutorial/time-series-forecasting-in-r)
22. []()
23. []()
24. []()

---

[<img src="文艺坊图库/Scibrokes.png" height="14"/> Sςιβrοκεrs Trαdιηg®](http://www.scibrokes.com)<br>
[**[<img src="文艺坊图库/Scibrokes.png" height="14"/> 世博量化®](http://www.scibrokes.com)企业知识产权及版权所有，盗版必究。**]{style="color:RoyalBlue"}
